(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"0cbc":function(t,e,a){},"10b3":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"purchasesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_embed=purchaseProducts&_expand=dealer&_expand=product&_expand=type&_expand=unit",table:"purchases",title:"⭐ รายการซื้อสินค้า ⭐",classes:t.settings.classes,columns:t.purchaseColumns,onInitAddData:t.onInitAddDataPurchases,onValidateData:t.onValidateDataPurchases,onBeforeLoadData:t.onBeforeLoadDataPurchases,onAfterLoadData:t.onAfterLoadDataPurchases,onBeforeUpdateData:t.onBeforeUpdateDataPurchases,onBeforeRemoveData:t.onBeforeRemoveDataPurchases,onAfterRemoveData:t.onAfterRemoveDataPurchases,rowsPerPage:5,selected:t.selectedRows,showSelectedRows:"",autoSelectRow:""},on:{"update:selected":[function(e){t.selectedRows=e},t.onSelectedRows]},scopedSlots:t._u([{key:"header",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"print",color:"accent",size:"xs",disable:t.selectedRow.total<=0},on:{click:function(){return t.printData(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-accent"}},[t._v("พิมพ์ข้อมูล")])],1)]}}])}),a("JsonTable",{ref:"purchaseProductsRef",attrs:{id:"scrollToThis","base-url":this.$global.data.baseUrl,params:{uid:t.UID},title:"⭐ "+t.titlePurchaseProducts+" ⭐",classes:t.settings.classes,columns:t.purchaseProductColumns,onInitAddData:t.onInitAddData,onInitEditData:t.onInitEditData,onValidateData:t.onValidateData,onAfterLoadData:t.onAfterLoadData,onFilterSelect:t.onFilterSelect,rowsPerPage:0,showEditDialog:t.showEditDialog,hidePagination:"",hideRefreshButton:"",hideSearchButton:""},on:{"add-row":function(e,a){return t.onUpdateRow(e,a)},"update-row":function(e,a){return t.onUpdateRow(e,a)},"update-cell":function(e,a,s){return t.onUpdateCell(e,a,s)},"remove-row":function(e,a){return t.onRemoveRow(e,a)},"input-select":function(e,a){return t.onInputSelect(e,a)}},scopedSlots:t._u([{key:"header",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"print",color:"accent",size:"xs",disable:t.selectedRow.total<=0},on:{click:function(){return t.printData(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-accent"}},[t._v("พิมพ์ข้อมูล")])],1)]}}]),model:{value:t.selectedRow.purchaseProducts,callback:function(e){t.$set(t.selectedRow,"purchaseProducts",e)},expression:"selectedRow.purchaseProducts"}}),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},["undefined"!==typeof t.selectedRow.id?a("div",{staticClass:"q-pa-none row wrap justify-center items-start content-start",staticStyle:{width:"780px",border:"1px solid black"},attrs:{id:"printBorder"}},[a("div",{staticClass:"q-pa-sm text-bold",staticStyle:{width:"722px","font-size":"larger"}},[a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            "+t._s(t.selectedRow.dealer.name||"ผู้จำหน่าย")+"\n          ")]),t.selectedRow.dealer.address?a("div",[t._v("\n            "+t._s(t.selectedRow.dealer.address)+"\n          ")]):t._e(),t.selectedRow.dealer.telephone?a("div",[t._v("\n            โทรศัพท์: "+t._s(t.selectedRow.dealer.telephone)+"\n          ")]):t._e(),a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            บิลซื้อสินค้า\n          ")]),t.selectedRow.date?a("div",{attrs:{align:"center"}},[t._v("\n            "+t._s(new Date(t.selectedRow.date).toLocaleString("th-TH",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))+"\n          ")]):t._e(),t.settings?a("div",{attrs:{align:"left"}},[t.settings.name?a("div",[t._v("\n              นาม: "+t._s(t.settings.name)+"\n            ")]):t._e(),t.settings.address?a("div",[t._v("\n              ที่อยู่: "+t._s(t.settings.address)+"\n            ")]):t._e(),t.settings.telephone?a("div",[t._v("\n              โทรศัพท์: "+t._s(t.settings.telephone)+"\n            ")]):t._e()]):t._e()]),a("div",{staticClass:"q-pa-none"},[t._m(0),t._l(t.selectedRow.purchaseProducts,(function(e){return a("div",{key:e.id,staticClass:"row"},[a("div",{staticClass:"col-1 text-center"},[t._v(t._s(e.quantity)+"\n              ")]),a("div",{staticClass:"q-px-xs col"},[t._v(t._s((e.product||{}).name))]),a("div",{staticClass:"col-auto text-right"},[t._v(t._s(t.applyDiscount(+e.discount,+e.price).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((t.applyDiscount(+e.discount,+e.price)*(+e.quantity||0)).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])}))],2),a("div",{staticClass:"q-pa-xs"}),a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-4"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("รวม:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s((t.selectedRow.purchaseProducts||[]).reduce((function(t,e){return t+e.quantity}),0)))]),a("div",{staticClass:"col"},[t._v(" หน่วย")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("จาก:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s((t.selectedRow.purchaseProducts||[]).length))]),a("div",{staticClass:"col"},[t._v(" รายการ")])])]),a("div",{staticClass:"col-7"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRow.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]),t.selectedRow.discount?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ส่วนลด:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" -"+t._s(t.applyPercentage(+t.selectedRow.discount,+t.selectedRow.total).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),t.selectedRow.vat?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ภาษี:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s(t.applyPercentage(+t.selectedRow.vat,t.applyDiscount(+t.selectedRow.discount,+t.selectedRow.total)).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมสุทธิ:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.applyVat(+t.selectedRow.vat,t.applyDiscount(+t.selectedRow.discount,+t.selectedRow.total)).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])]),t.selectedRow.cash?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ชำระเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRow.cash||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),t.selectedRow.cash?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ทอนเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRow.change||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e()])])]),t._m(1)])]):t._e()]),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.cashDialog,callback:function(e){t.cashDialog=e},expression:"cashDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.titlePurchaseProducts))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",[a("div",{staticClass:"q-pr-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-sm col-md-auto rounded-borders bg-grey-4"},[a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"1"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?1:+(""+t.cashValue+1)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"2"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?2:+(""+t.cashValue+2)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"3"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?3:+(""+t.cashValue+3)}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"4"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?4:+(""+t.cashValue+4)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"5"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?5:+(""+t.cashValue+5)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"6"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?6:+(""+t.cashValue+6)}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"7"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?7:+(""+t.cashValue+7)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"8"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?8:+(""+t.cashValue+8)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"9"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?9:+(""+t.cashValue+9)}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"cyan",size:"md",label:"C"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?0:t.netValue}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"0"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?0:+(""+t.cashValue+0)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"cyan",size:"md",label:"<"},on:{click:function(e,a){return t.cashValue=+(""+t.cashValue).slice(0,-1)}}})],1)])]),a("div",{staticClass:"q-pl-sm col"},[a("q-input",{staticClass:"no-spin-button",attrs:{type:"number",autofocus:!t.$global.isMobileAgent(),label:"ชำระเงิน","input-class":"text-right text-h3",rules:[function(t){return t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(){return t.cashValue>0&&t.selectedRow.id&&t.updateCashPurchases(t.selectedRow)}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()}},model:{value:t.cashValue,callback:function(e){t.cashValue=t._n(e)},expression:"cashValue"}}),a("q-input",{attrs:{value:+(+t.netValue||0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ราคาสุทธิ","input-class":"text-right text-h3"}}),a("q-input",{attrs:{value:+(+t.cashValue>(+t.netValue||0)?+t.cashValue-(+t.netValue||0):0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ทอนเงิน","input-class":"text-right text-h3"}})],1)])])]),a("q-card-section",[a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{glossy:"",color:"grey",label:"1000"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?1e3:t.cashValue+1e3}}}),a("q-btn",{attrs:{glossy:"",color:"purple",label:"500"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?500:t.cashValue+500}}}),a("q-btn",{attrs:{glossy:"",color:"red",label:"100"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?100:t.cashValue+100}}}),a("q-btn",{attrs:{glossy:"",color:"blue",label:"50"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?50:t.cashValue+50}}}),a("q-btn",{attrs:{glossy:"",color:"green",label:"20"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?20:t.cashValue+20}}})],1),a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-10",label:"10"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?10:t.cashValue+10}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-9",label:"5"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?5:t.cashValue+5}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-8",label:"2"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?2:t.cashValue+2}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-7",label:"1"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?1:t.cashValue+1}}})],1),a("q-separator")],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ย้อนกลับไป"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"secondary",label:"จ่ายเงิน ไม่พิมพ์",disable:t.cashValue<=0||t.cashValue<(+t.netValue||0)},on:{click:function(e,a){return t.cashValue>0&&t.selectedRow.id&&t.updateCashPurchases(t.selectedRow,!1)}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"positive",label:"จ่ายเงิน และพิมพ์",disable:t.cashValue<=0||t.cashValue<(+t.netValue||0)},on:{click:function(e,a){return t.cashValue>0&&t.selectedRow.id&&t.updateCashPurchases(t.selectedRow)}}})],1)],1)],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",staticStyle:{"text-decoration":"underline"}},[a("div",{staticClass:"col-1 text-center"},[t._v("จำนวน")]),a("div",{staticClass:"col text-center"},[t._v("รายการ")]),a("div",{staticClass:"col-auto text-right"},[t._v("ราคา")]),a("div",{staticClass:"col-3 text-right"},[t._v("รวม")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6"},[t._v("\n            ขอบคุณที่ใช้บริการ\n          ")])])}],n=(a("99af"),a("7db0"),a("4160"),a("caad"),a("c975"),a("e260"),a("13d5"),a("45fc"),a("a434"),a("b0c0"),a("2af1"),a("b680"),a("cca6"),a("b64b"),a("d3b7"),a("e6cf"),a("ac1f"),a("2532"),a("3ca3"),a("1276"),a("159b"),a("ddb0"),a("7037")),o=a.n(n),l=a("ec67"),r=a("1732"),c="bg-blue-1",d="bg-yellow",u={name:"PagePurchases",data:function(){var t=this;return{EDITE_CLASS:c,ERROR_CLASS:d,purchaseColumns:[{name:"id",label:"รหัสซื้อ",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"date",label:"วัน/เดือน/ปี เวลา",field:"date",format:function(t,e){return"".concat(new Date(t).toLocaleString())},sortable:!0,classes:"text-green-10 text-center",edit:{type:"datetime",inputClass:"",prefix:"",suffix:""}},{name:"dealerId",label:"ผู้จำหน่าย",field:"dealerId",sortable:!0,classes:"text-green-10 text-left",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"total",label:"รวม",field:"total",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"vat",label:"ภาษี",field:"vat",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"net",label:"รวมสุทธิ",field:function(e){return t.getNetValue(e)},sortable:!0,headerClasses:"text-weight-bold",classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"cash",label:"ชำระเงิน",field:"cash",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"change",label:"ทอนเงิน",field:"change",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],purchaseProductColumns:[{name:"product.id",label:"รหัสสินค้า",field:function(t){return(t.product||{}).id},sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.type.name",label:"ประเภทสินค้า",field:function(t){return(t.product||{type:{}}).type.name},sortable:!0,classes:"text-center",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.unit.name",label:"หน่วยนับ",field:function(t){return(t.product||{unit:{}}).unit.name},sortable:!0,classes:"text-center",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"productId",label:"ชื่อสินค้า",field:"productId",sortable:!0,classes:"text-left",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:"",optionLabel:function(t){return t.name?"".concat(t.name):""},optionDetail:function(t){return"★ (ขาย ".concat(t.price||0," บาท) (ทุน ").concat(t.cost||0," บาท) (เหลือ ").concat(t.quantity," ").concat((t.unit||{name:"หน่วย"}).name,")")}}},{name:"price",label:"ราคาซื้อ",field:"price",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"price.discount",label:"ราคาทุน",field:function(e){return t.applyDiscount(e.discount,e.price)},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวน",field:"quantity",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"total",label:"รวม",field:function(e){return t.applyDiscount(e.discount,e.price)*(e.quantity||1)},sortable:!0,classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"sale",label:"ราคาขาย",field:"sale",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],titlePurchaseProducts:"ซื้อสินค้า",selectedRows:[],selectedRow:{},isRequireLoadDataPurchases:!1,isRequireLoadDataPurchaseProducts:!1,isEditMode:!1,showEditDialog:!1,cashDialog:!1,cashValue:0,netValue:0,dialogPos:{x:0,y:0}}},components:{JsonTable:l["a"]},beforeCreate:function(){this.UID=Object(r["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}}},watch:{"$global.data.modify":function(t,e){if(t.request&&t.request.query&&t.request.query.uid!==this.UID){var a=t.request.path.split("/");!this.isEditMode&&(a.includes("purchases")||a.includes("purchaseProducts")||a.includes("products"))?this.$global.data.panelModel===this.$options.name?this.$refs.purchasesRef.onRequest():this.isRequireLoadDataPurchases||(this.isRequireLoadDataPurchases=!0):a.includes("dealers")&&this.loadDefaultDealer()}},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataPurchases&&(this.isRequireLoadDataPurchases=!1,this.$refs.purchasesRef.onRequest())}},mounted:function(){this.loadDefaultDealer()},methods:{loadDefaultDealer:function(){var t=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/dealers/1"),{params:{uid:this.UID}}).then((function(e){t.defaultDealer=e.data})).catch((function(e){t.defaultDealer={}}))},onInitAddDataPurchases:function(t){var e=this;if(this.isEditMode){if(this.$refs.purchasesRef.data.find((function(t){return t.id>0})))return this.$q.notify({type:"warning",message:"ไม่อนุญาตให้เพิ่มข้อมูลในขณะที่กำลังมีการแก้ไขข้อมูล"}),!0}else this.isEditMode=!0,this.$refs.purchasesRef.data.length=0;return this.$refs.purchasesRef.data.length<this.$refs.purchasesRef.pagination.rowsPerPage?(this.$refs.purchasesRef.data.push(t),this.$refs.purchasesRef.pagination.rowsNumber=this.$refs.purchasesRef.data.length,this.selectedRows=[t],t.id=-this.$refs.purchasesRef.data.length,t.date=(new Date).toISOString(),t.discount=0,t.vat=this.settings.vatPurchase,t.total=0,t.cash=0,t.change=0,t.dealerId=(this.selectedRow||{}).dealerId||this.defaultDealer.id||1,t.dealer=(this.selectedRow||{}).dealer||this.defaultDealer||{},t.purchaseProducts=[],t.__class__=c,this.$global.scrollToElement("scrollToThis",(function(){return e.$refs.purchaseProductsRef.addRow("undefined"===typeof e.$refs.purchaseProductsRef.__new__)}),1e3,1e3)):this.$q.notify({type:"warning",message:"ไม่อนุญาตให้เพิ่มข้อมูลมากกว่าจำนวนของ แถวต่อหน้า (".concat(this.$refs.purchasesRef.pagination.rowsPerPage,")")}),!0},onValidateDataPurchases:function(t,e,a){return"dealerId"===a.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลผู้จำหน่าย":"text"===a.edit.type||"textarea"===a.edit.type||"date"===a.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":("number"===a.edit.type||a.edit.type,!0)},onBeforeLoadDataPurchases:function(t,e){var a=this;if(this.isEditMode)return new Promise((function(t,e){a.$q.dialog({title:"การรีเฟรชข้อมูล",message:"กรุณายืนยันการรีเฟรชข้อมูล ?",ok:{glossy:!0,push:!0,color:"negative",label:"ตกลง"},cancel:{glossy:!0,push:!0,color:"primary",label:"ยกเลิก"},focus:"cancel"}).onOk((function(){a.isEditMode=!1,t(void 0)})).onCancel((function(){t(!0)}))}))},onAfterLoadDataPurchases:function(t,e){e.forEach((function(t){return Array.isArray(t.purchaseProducts)&&t.purchaseProducts.forEach((function(t){return t.__old__=Object.assign({},t.__old__,{quantity:t.quantity})}))})),document.activeElement.blur()},onBeforeUpdateDataPurchases:function(t,e,a){return this.isEditMode||(this.isEditMode=!0,this.$refs.purchasesRef.data.length=0,this.$refs.purchasesRef.data.push(e),this.$refs.purchasesRef.pagination.rowsNumber=this.$refs.purchasesRef.data.length,this.selectedRows=[e]),e.cash<0&&(e.cash=0),e.total>0&&e.cash>0?e.change=+(e.cash-this.applyVat(e.vat,this.applyDiscount(e.discount,e.total))).toFixed(this.settings.fractionDigits):e.change=0,e.change<0&&(e.change=0),e.__row__&&Object.keys(e.__row__).forEach((function(t){"object"!==o()(e.__row__[t])&&e.__row__[t]!==e[t]&&(e.__row__[t]=e[t])})),e.__class__=c,e.__row__&&(e.__row__.__class__=c),!0},onBeforeRemoveDataPurchases:function(t,e){var a=this;if(e.id<0){var s=this.$refs.purchasesRef.data.indexOf(e);if(s>=0)return this.$refs.purchasesRef.data.splice(s,1),this.$refs.purchasesRef.data.length>0?(this.$refs.purchasesRef.pagination.rowsNumber=this.$refs.purchasesRef.data.length,this.selectedRows=[this.$refs.purchasesRef.data[0]]):(this.isEditMode=!1,this.$nextTick((function(){return a.$refs.purchasesRef.onRequest()}))),!0}},onAfterRemoveDataPurchases:function(t,e,a){var s=this;e.purchaseProducts&&[].concat(e.purchaseProducts,e.purchaseProducts.__deleted__||[]).forEach((function(t){t.id&&s.$jsonFetch.delete("".concat(s.$global.data.baseUrl,"/purchaseProducts/").concat(t.id),void 0,{params:{uid:s.UID}}).then((function(e){s.updateQuantityProduct({productId:t.productId,quantity:0,__old__:t.__old__}).then((function(t){})).catch((function(t){}))})).catch((function(t){}))}))},onSelectedRows:function(t){t.length>0?(this.selectedRow=t[0],this.titlePurchaseProducts="ซื้อสินค้า ".concat((this.selectedRow.dealer||{}).name," [").concat(this.selectedRow.id||"กำลังเพิ่มข้อมูลใหม่","]")):(this.selectedRow={},this.titlePurchaseProducts="ซื้อสินค้า"),document.activeElement.blur()},onInitAddData:function(t){if("undefined"===typeof this.selectedRow.id)return this.$q.notify({type:"warning",message:"ยังไม่ได้เลือกรายการซื้อสินค้า"}),this.showEditDialog=!1,!0;t.purchaseId=this.selectedRow.id,t.quantity=+this.settings.quantityPurchase,t.discount=0,t.sale=0,t.__old__={quantity:0},t.__class__=c},onInitEditData:function(t){if("undefined"===typeof this.selectedRow.id)return this.$q.notify({type:"warning",message:"ยังไม่ได้เลือกรายการซื้อสินค้า"}),this.showEditDialog=!1,!0;t.purchaseId=this.selectedRow.id,t.__old__=Object.assign({},t.__old__),t.__class__=c},onValidateData:function(t,e,a){return"productId"===a.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลสินค้า":"quantity"===a.name&&t<=0?"จำนวนสินค้าต้องมีค่ามากกว่า 0":"text"===a.edit.type||"textarea"===a.edit.type||"date"===a.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==a.edit.type&&"decimal"!==a.edit.type||(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0")},onAfterLoadData:function(t,e){document.activeElement.blur()},onInputSelect:function(t,e){t.product&&(t.price=t.product.cost,t.sale=t.product.price)},onFilterSelect:function(t,e,a){this.$refs.purchasesRef.data.forEach((function(t){(t.id<0||t.__class__)&&(t.purchaseProducts.__deleted__&&t.purchaseProducts.__deleted__.forEach((function(t){var e=a.find((function(e){return e.id===t.productId}));e&&(e.quantity-=t.__old__.quantity)})),t.purchaseProducts.forEach((function(t){if(t.__class__){var e=a.find((function(e){return e.id===t.productId}));e&&(e.quantity+=t.quantity-t.__old__.quantity)}})))}))},onUpdateRow:function(t,e){if(this.$refs.purchaseProductsRef.setShowEditDialog(!1),e&&e.productId&&e.product){var a=this.applyDiscount(e.discount,e.price);if(e.sale=e.sale>0?e.sale:Math.round(a+a*this.settings.profit/100),!0!==this.onValidateData(e.quantity,e,{edit:{},name:"quantity"}))return this.$q.loading.hide();var s=this.selectedRow.purchaseProducts.find((function(t){return t.productId===e.productId}));s?(Object.keys(s).forEach((function(t){"quantity"!==t&&"object"!==o()(s[t])&&"undefined"!==typeof e[t]&&s[t]!==e[t]&&("discount"===t&&0===e[t]||(s[t]=e[t]))})),s.quantity+=e.quantity-e.__row__.quantity,s.__class__=c):this.selectedRow.purchaseProducts.push(e),this.selectedRow.total=this.getTotalValue(this.selectedRow.purchaseProducts),this.selectedRow.total<0&&(this.selectedRow.total=0),this.selectedRow.__class__=c}},onUpdateCell:function(t,e,a){this.$refs.purchaseProductsRef.setShowEditDialog(!1),this.selectedRow.total=this.getTotalValue(this.selectedRow.purchaseProducts),this.selectedRow.total<0&&(this.selectedRow.total=0),e.__class__=c,this.selectedRow.__class__=c},onRemoveRow:function(t,e){var a=this;e&&this.$q.dialog({title:"การลบข้อมูล",message:"กรุณายืนยันการลบข้อมูลของ ".concat((e.product||{}).name||""," ?"),ok:{glossy:!0,push:!0,color:"negative",label:"ตกลง"},cancel:{glossy:!0,push:!0,color:"primary",label:"ยกเลิก"},focus:"cancel"}).onOk((function(){var t=a.selectedRow.purchaseProducts.indexOf(e);t>=0&&(a.selectedRow.purchaseProducts.splice(t,1),a.selectedRow.total=a.getTotalValue(a.selectedRow.purchaseProducts),a.selectedRow.total<0&&(a.selectedRow.total=0),e.id>0&&(a.selectedRow.purchaseProducts.__deleted__=[].concat(a.selectedRow.purchaseProducts.__deleted__||[],e)),a.selectedRow.__class__=c)}))},getDecimal:function(t){return(+t||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits})},getTotalValue:function(t){var e=this;return+t.reduce((function(t,a){return t+e.applyDiscount(a.discount,a.price)*a.quantity}),0).toFixed(this.settings.fractionDigits)},getNetValue:function(t){return t.total>0?this.applyVat(t.vat,this.applyDiscount(t.discount,t.total)):0},applyPercentage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.sign(t)<0?e*t/-100:t},applyDiscount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e-this.applyPercentage(t,e);return a>=0?a:e},applyVat:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e+this.applyPercentage(t,e);return a>=0?a:e},printData:function(t){var e=this;this.selectedRow.total>0&&(this.isEditMode||this.$refs.purchasesRef.data.some((function(t){return"undefined"!==typeof t.__class__}))?(this.netValue=this.getNetValue(this.selectedRow),this.cashValue=this.netValue,this.cashDialog=!0):this.selectedRow.cash>0&&(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return e.printBorderVisibility(!0)}))))},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"},updateQuantityProduct:function(t){var e=this;return new Promise((function(a,s){var i={quantityDelta:+(+t.quantity-+t.__old__.quantity).toFixed(e.settings.fractionDigits)};t.sale&&(i.cost=t.price-t.discount,i.price=t.sale),e.$jsonFetch.patch("".concat(e.$global.data.baseUrl,"/products/").concat(t.productId),i,{params:{uid:e.UID}}).then((function(t){a(t)})).catch((function(t){s(t)}))}))},updateCashPurchases:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(s,i){e.$q.loading.show(),e.cashDialog=!1,t.total=e.getTotalValue(t.purchaseProducts),t.total<0&&(t.total=0),t.cash=e.cashValue,t.change=+(t.cash-e.applyVat(t.vat,e.applyDiscount(t.discount,t.total))).toFixed(e.settings.fractionDigits),t.change<0&&(t.change=0);var n,o=e.$refs.purchasesRef.shallowCopy(t);o.id<0?(delete o.id,n=e.$jsonFetch.post("".concat(e.$global.data.baseUrl,"/purchases"),o,{params:{uid:e.UID}})):n=e.$jsonFetch.patch("".concat(e.$global.data.baseUrl,"/purchases"),o,{params:{uid:e.UID}}),n.then((function(n){t.id=n.data.id;var o=[];t.purchaseProducts.__deleted__&&t.purchaseProducts.__deleted__.forEach((function(a){return!(a.quantity=0)&&a.quantity!==a.__old__.quantity&&o.push(e.updateQuantityProduct(a).then((function(t){a.id&&e.$jsonFetch.delete("".concat(e.$global.data.baseUrl,"/purchaseProducts/").concat(a.id),void 0,{params:{uid:e.UID}}).then((function(t){})).catch((function(t){}))})).catch((function(s){e.$set(a,"__class__",d),t.__class__||e.$set(t,"__class__",a.__class__)})))})),t.purchaseProducts.forEach((function(a){return a.quantity!==a.__old__.quantity&&o.push(e.updateQuantityProduct(a).then((function(s){a.purchaseId=t.id,e.$jsonFetch.post("".concat(e.$global.data.baseUrl,"/purchaseProducts"),e.$refs.purchasesRef.shallowCopy(a),{params:{uid:e.UID}}).then((function(t){})).catch((function(t){}))})).catch((function(s){e.$set(a,"__class__",d),t.__class__||e.$set(t,"__class__",a.__class__)})))})),Promise.all(o).then((function(i){var o=e.$refs.purchasesRef.data.indexOf(t);o>=0&&e.$refs.purchasesRef.data.splice(o,1),delete t.__class__,e.isEditMode=!1,e.$nextTick((function(){return e.$refs.purchasesRef.onRequest()})),a&&e.printData(),e.$q.loading.hide(),s(n)})).catch((function(t){e.$q.loading.hide(),i(t)}))})).catch((function(t){e.$q.loading.hide(),i(t)}))}))},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}},_debug:function(){var t;(t=console).log.apply(t,arguments)}}},p=u,f=(a("f86d"),a("2877")),h=a("9c40"),m=a("05c0"),g=a("24e8"),b=a("f09f"),y=a("a370"),_=a("d847"),v=a("2c91"),x=a("27f9"),w=a("eb85"),q=a("4b7e"),D=a("75c3"),C=a("7f67"),R=a("eebe"),P=a.n(R),$=Object(f["a"])(p,s,i,!1,null,"5c0ef70f",null);e["a"]=$.exports;P()($,"components",{QBtn:h["a"],QTooltip:m["a"],QDialog:g["a"],QCard:b["a"],QCardSection:y["a"],QBar:_["a"],QSpace:v["a"],QInput:x["a"],QSeparator:w["a"],QCardActions:q["a"]}),P()($,"directives",{TouchPan:D["a"],ClosePopup:C["a"]})},"342fd":function(t,e,a){},"3eb8":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"column"},[a("q-card",{staticClass:"fit",staticStyle:{background:"radial-gradient(circle, #44ccff 0%, #4466aa 100%)"}},[a("q-card-section",{staticClass:"q-pa-md fit row wrap justify-center"},[a("q-input",{staticClass:"q-px-md",attrs:{type:"date",dense:"","stack-label":"",label:"เริ่มจากวันที่"},on:{focus:function(e){return t.selectOnFocus(e)}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),a("q-input",{staticClass:"q-px-md",attrs:{type:"date",dense:"","stack-label":"",label:"ไปจนถึงวันที่"},on:{focus:function(e){return t.selectOnFocus(e)}},model:{value:t.stopDate,callback:function(e){t.stopDate=e},expression:"stopDate"}}),a("q-btn",{attrs:{glossy:"",padding:"sm",icon:"grade",color:"pink",size:"md",label:"แสดงข้อมูล"},on:{click:function(){return t.getSummary()}}})],1),a("q-card-section",{staticClass:"q-pa-xs"},[a("q-separator")],1),a("q-card-section",{staticClass:"q-gutter-md fit row wrap justify-evenly items-start content-start"},[a("div",{staticClass:"q-pa-md rounded-borders text-h6 bg-light-green"},[a("table",[a("tbody",[a("tr",[a("td",{staticClass:"text-center",staticStyle:{"text-decoration":"underline"},attrs:{colspan:"100%"}},[t._v("สรุปยอดขาย")])]),a("tr",[a("td",{staticClass:"text-left",staticStyle:{"min-width":"300px"}},[t._v("ขายสินค้า")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.netSale.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v("ทุนสินค้า")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.costSale.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v("กำไรที่ได้มา")]),a("td",{staticClass:"text-right"},[t._v(t._s((t.netSale-t.costSale).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-center",staticStyle:{"text-decoration":"underline"},attrs:{colspan:"100%"}},[t._v("สินค้าขายดี")])]),a("tr",[a("td",{staticClass:"text-left",staticStyle:{"min-width":"300px"}},[t._v(t._s(t.nameTotalSale1))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxTotalSale1.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameTotalSale2))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxTotalSale2.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameTotalSale3))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxTotalSale3.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-center",staticStyle:{"text-decoration":"underline"},attrs:{colspan:"100%"}},[t._v("สินค้าขายมาก")])]),a("tr",[a("td",{staticClass:"text-left",staticStyle:{"min-width":"300px"}},[t._v(t._s(t.nameQuantitySale1))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxQuantitySale1.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v(t._s(t.nameUnitSale1))])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameQuantitySale2))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxQuantitySale2.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v(t._s(t.nameUnitSale2))])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameQuantitySale3))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxQuantitySale3.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v(t._s(t.nameUnitSale3))])])])])]),a("div",{staticClass:"q-pa-md rounded-borders text-h6 bg-orange-4"},[a("table",[a("tbody",[a("tr",[a("td",{staticClass:"text-center",staticStyle:{"text-decoration":"underline"},attrs:{colspan:"100%"}},[t._v("สรุปยอดซื้อ")])]),a("tr",[a("td",{staticClass:"text-left",staticStyle:{"min-width":"300px"}},[t._v("ซื้อสินค้า")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.netPurchase.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v("ขายสินค้า")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.salePurchase.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v("กำไรที่จะได้")]),a("td",{staticClass:"text-right"},[t._v(t._s((t.salePurchase-t.netPurchase).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-center",staticStyle:{"text-decoration":"underline"},attrs:{colspan:"100%"}},[t._v("สินค้าซื้อบ่อย")])]),a("tr",[a("td",{staticClass:"text-left",staticStyle:{"min-width":"300px"}},[t._v(t._s(t.nameTotalPurchase1))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxTotalPurchase1.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameTotalPurchase2))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxTotalPurchase2.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameTotalPurchase3))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxTotalPurchase3.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-center",staticStyle:{"text-decoration":"underline"},attrs:{colspan:"100%"}},[t._v("สินค้าซื้อมาก")])]),a("tr",[a("td",{staticClass:"text-left",staticStyle:{"min-width":"300px"}},[t._v(t._s(t.nameQuantityPurchase1))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxQuantityPurchase1.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v(t._s(t.nameUnitPurchase1))])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameQuantityPurchase2))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxQuantityPurchase2.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v(t._s(t.nameUnitPurchase2))])]),a("tr",[a("td",{staticClass:"text-left"},[t._v(t._s(t.nameQuantityPurchase3))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.maxQuantityPurchase3.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})))]),a("td",{staticClass:"text-left"},[t._v(t._s(t.nameUnitPurchase3))])])])])])])],1)],1)])},i=[],n=(a("99af"),a("7db0"),a("4160"),a("e260"),a("13d5"),a("b0c0"),a("2af1"),a("d3b7"),a("e6cf"),a("ac1f"),a("3ca3"),a("1276"),a("159b"),a("ddb0"),a("1732")),o={name:"PageSummary",data:function(){return{startDate:(new Date).toISOString().split("T")[0],stopDate:(new Date).toISOString().split("T")[0],costSale:0,netSale:0,salePurchase:0,netPurchase:0,maxTotalSale1:0,maxTotalSale2:0,maxTotalSale3:0,maxQuantitySale1:0,maxQuantitySale2:0,maxQuantitySale3:0,maxTotalPurchase1:0,maxTotalPurchase2:0,maxTotalPurchase3:0,maxQuantityPurchase1:0,maxQuantityPurchase2:0,maxQuantityPurchase3:0,nameTotalSale1:"",nameTotalSale2:"",nameTotalSale3:"",nameQuantitySale1:"",nameQuantitySale2:"",nameQuantitySale3:"",nameUnitSale1:"หน่วย",nameUnitSale2:"หน่วย",nameUnitSale3:"หน่วย",nameTotalPurchase1:"",nameTotalPurchase2:"",nameTotalPurchase3:"",nameQuantityPurchase1:"",nameQuantityPurchase2:"",nameQuantityPurchase3:"",nameUnitPurchase1:"หน่วย",nameUnitPurchase2:"หน่วย",nameUnitPurchase3:"หน่วย"}},beforeCreate:function(){this.UID=Object(n["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}}},methods:{getSummary:function(){var t=this,e=this.startDate.split("T")[0]+"T00:00:00.000Z",a=this.stopDate.split("T")[0]+"T23:59:59.999Z";this.$q.loading.show();var s=0,i=0,n=0,o=0,l=0,r=0,c=0,d=0,u=0,p=0,f=0,h=0;Promise.all([this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/sales?_embed=saleProducts&date_gte=").concat(e,"&date_lte=").concat(a),{params:{uid:this.UID}}).then((function(e){var a=0,c=0,d=0,u=0,p=0,f=0,h=0,m=0,g={},b={};for(var y in e.data.forEach((function(e){a+=e.saleProducts.reduce((function(e,a){return g[a.productId]=(g[a.productId]||0)+t.applyDiscount(a.discount,a.price)*a.quantity,b[a.productId]=(b[a.productId]||0)+a.quantity,e+(a.cost||a.price||0)*(a.quantity||0)}),0),c+=(e.cash||0)-(e.change||0)})),g){var _=g[y];_>d?(d=_,s=+y):_>u&&_<d?(u=_,i=+y):_>p&&_<u&&(p=_,n=+y)}for(var v in b){var x=b[v];x>f?(f=x,o=+v):x>h&&x<f?(h=x,l=+v):x>m&&x<h&&(m=x,r=+v)}t.costSale=a,t.netSale=c,t.maxTotalSale1=d,t.maxTotalSale2=u,t.maxTotalSale3=p,t.maxQuantitySale1=f,t.maxQuantitySale2=h,t.maxQuantitySale3=m})).catch((function(t){})),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/purchases?_embed=purchaseProducts&date_gte=").concat(e,"&date_lte=").concat(a),{params:{uid:this.UID}}).then((function(e){var a=0,s=0,i=0,n=0,o=0,l=0,r=0,m=0,g={},b={};for(var y in e.data.forEach((function(e){a+=e.purchaseProducts.reduce((function(e,a){return g[a.productId]=(g[a.productId]||0)+t.applyDiscount(a.discount,a.price)*a.quantity,b[a.productId]=(b[a.productId]||0)+a.quantity,e+(a.sale||a.price||0)*(a.quantity||0)}),0),s+=t.applyVat(e.vat,t.applyDiscount(e.discount,e.total||0))})),g){var _=g[y];_>i?(i=_,c=+y):_>n&&_<i?(n=_,d=+y):_>o&&_<n&&(o=_,u=+y)}for(var v in b){var x=b[v];x>l?(l=x,p=+v):x>r&&x<l?(r=x,f=+v):x>m&&x<r&&(m=x,h=+v)}t.salePurchase=a,t.netPurchase=s,t.maxTotalPurchase1=i,t.maxTotalPurchase2=n,t.maxTotalPurchase3=o,t.maxQuantityPurchase1=l,t.maxQuantityPurchase2=r,t.maxQuantityPurchase3=m})).catch((function(t){}))]).then((function(){return t.$jsonFetch.get("".concat(t.$global.data.baseUrl,"/products?_expand=unit&id=").concat(s,"&id=").concat(i,"&id=").concat(n,"&id=").concat(o,"&id=").concat(l,"&id=").concat(r,"&id=").concat(c,"&id=").concat(d,"&id=").concat(u,"&id=").concat(p,"&id=").concat(f,"&id=").concat(h),{params:{uid:t.UID}}).then((function(e){t.nameTotalSale1=(e.data.find((function(t){return t.id===s}))||{}).name||"",t.nameTotalSale2=(e.data.find((function(t){return t.id===i}))||{}).name||"",t.nameTotalSale3=(e.data.find((function(t){return t.id===n}))||{}).name||"",t.nameQuantitySale1=(e.data.find((function(t){return t.id===o}))||{}).name||"",t.nameQuantitySale2=(e.data.find((function(t){return t.id===l}))||{}).name||"",t.nameQuantitySale3=(e.data.find((function(t){return t.id===r}))||{}).name||"",t.nameUnitSale1=((e.data.find((function(t){return t.id===o}))||{}).unit||{}).name||"หน่วย",t.nameUnitSale2=((e.data.find((function(t){return t.id===l}))||{}).unit||{}).name||"หน่วย",t.nameUnitSale3=((e.data.find((function(t){return t.id===r}))||{}).unit||{}).name||"หน่วย",t.nameTotalPurchase1=(e.data.find((function(t){return t.id===c}))||{}).name||"",t.nameTotalPurchase2=(e.data.find((function(t){return t.id===d}))||{}).name||"",t.nameTotalPurchase3=(e.data.find((function(t){return t.id===u}))||{}).name||"",t.nameQuantityPurchase1=(e.data.find((function(t){return t.id===p}))||{}).name||"",t.nameQuantityPurchase2=(e.data.find((function(t){return t.id===f}))||{}).name||"",t.nameQuantityPurchase3=(e.data.find((function(t){return t.id===h}))||{}).name||"",t.nameUnitPurchase1=((e.data.find((function(t){return t.id===p}))||{}).unit||{}).name||"หน่วย",t.nameUnitPurchase2=((e.data.find((function(t){return t.id===f}))||{}).unit||{}).name||"หน่วย",t.nameUnitPurchase3=((e.data.find((function(t){return t.id===h}))||{}).unit||{}).name||"หน่วย",t.$q.loading.hide()})).catch((function(e){t.$q.loading.hide()}))})).catch((function(e){t.$q.loading.hide()}))},applyPercentage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.sign(t)<0?e*t/-100:t},applyDiscount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e-this.applyPercentage(t,e);return a>=0?a:e},applyVat:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e+this.applyPercentage(t,e);return a>=0?a:e},selectOnFocus:function(t){t&&t.target&&"function"===typeof t.target.select&&t.target.select()},_debug:function(){var t;(t=console).log.apply(t,arguments)}}},l=o,r=a("2877"),c=a("f09f"),d=a("a370"),u=a("27f9"),p=a("9c40"),f=a("eb85"),h=a("eebe"),m=a.n(h),g=Object(r["a"])(l,s,i,!1,null,null,null);e["a"]=g.exports;m()(g,"components",{QCard:c["a"],QCardSection:d["a"],QInput:u["a"],QBtn:p["a"],QSeparator:f["a"]})},"49de":function(t,e,a){"use strict";(function(t){a("99af"),a("caad"),a("e260"),a("a15b"),a("d81d"),a("fb6a"),a("a434"),a("b0c0"),a("cca6"),a("d3b7"),a("e6cf"),a("ac1f"),a("25f0"),a("3ca3"),a("5319"),a("1276"),a("ddb0"),a("2b3d");var s=a("278c"),i=a.n(s),n=a("fbb2"),o=a("10b3"),l=a("7d5b"),r=a("5eaa"),c=a("7079"),d=a("caa3"),u=a("3eb8"),p=a("f9ea"),f=a("1732"),h=["POST","PUT","PATCH","DELETE"],m=100;e["a"]={name:"MainLayout",data:function(){return{table:"settings",isLoaded:!1,menuModel:!1,panelModel:"PageSales",logs:[],showSetJsonServer:!1,showAuthentication:!1,eventDialog:!1,importDialog:!1,exportDialog:!1,exitDialog:!1,baseUrl:"",user:"",password:"",importFile:void 0,dialogPos:{x:0,y:0}}},components:{Sales:n["a"],Purchases:o["a"],Customers:l["a"],Dealers:r["a"],Products:c["a"],PrintBarcode:d["a"],Summary:u["a"],Settings:p["a"]},beforeCreate:function(){var t=this;this.$on("error",(function(e){t.appendLogs("".concat(e,"\n"))})),this.UID=Object(f["a"])(),this.$global.stopBrowserBack((function(t){return confirm("กรุณายืนยันการปิดระบบ")}))},created:function(){this.clearCache()},mounted:function(){var t=this;this.$set(this.$global.data,"baseUrl","".concat(localStorage.getItem("baseUrl")||window.location.origin,"/api").replace(/([^:])\/\//g,"$1/")),this.$set(this.$global.data,"users",void 0),this.$set(this.$global.data,"settings",void 0),this.$set(this.$global.data,"images",void 0),this.$set(this.$global.data,"modify",void 0),this.$set(this.$global.data,"panelModel",this.panelModel),this.baseUrl=this.$global.data.baseUrl.replace(/\/api$/,""),this.$jsonFetch.onError=function(e){if(e.response&&401===e.response.status)setTimeout((function(){t.$q.loading.hide(),t.showAuthentication=!0}),1e3);else{var a=e.response?"Error: ".concat(e.response.status," - ").concat(e.response.statusText):"Error: ".concat(e.message.slice(0,100));console.error(a),t.$emit("error",a),t.$q.notify({type:"negative",message:a}),t.$q.loading.hide()}},this.setDefaultsNotify(),console.log("Check Settings"),this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.images={logo:localStorage.getItem("logo"),logoColor:localStorage.getItem("logoColor")},this.$jsonFetch.get("".concat(this.baseUrl)).then((function(e){"OK"===e.data?t.loadSettings():(t.$q.loading.hide(),t.showSetJsonServer=!0)})).catch((function(e){t.$q.loading.hide(),t.showSetJsonServer=!0}))},computed:{settings:{get:function(){return this.$global.data.settings||{}}},images:{get:function(){return this.$global.data.images||{}},set:function(t){this.$global.data.images={logo:localStorage.getItem("logo"),logoColor:localStorage.getItem("logoColor")}}},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}},log:function(){return this.logs.join("")}},watch:{"$global.data.settings.update":function(t,e){var a=this;"undefined"!==typeof t&&this.$q.notify({message:'<div style="text-align: center; font-weight: bold;"><div style="font-size: large; text-decoration: underline;">'.concat(this.settings.name).concat(t?" เวอร์ชั่น: "+t:"","</div>ระบบมีเวอร์ชั่นใหม่แล้ว คุณต้องการเริ่มระบบใหม่ตอนนี้เลยมั้ย?</div>"),position:"top",color:"purple",timeout:0,actions:[{label:"เริ่มระบบใหม่",color:"yellow",handler:function(){a.$jsonFetch.patch("".concat(a.$global.data.baseUrl,"/").concat(a.table,"/").concat(a.$global.data.settings.id),{update:null},{params:{uid:a.UID}}).then((function(t){a.refreshPage()})).catch((function(t){}))}}]})},panelModel:function(t,e){this.$global.data.panelModel=t}},methods:{clearCache:function(){var t=+localStorage.getItem("timeCache");Date.now()-t>6e4&&(localStorage.setItem("timeCache",Date.now()),"serviceWorker"in navigator&&caches.keys().then((function(t){return Promise.all(t.map((function(t){return caches.delete(t)})))})).then((function(){navigator.serviceWorker.getRegistrations().then((function(t){return Promise.all(t.map((function(t){return t.unregister()})))})).then((function(){return window.location.reload()}))})))},setLocalStorageFromFile:function(t,e){var a=this;if(t&&e){var s=new FileReader;s.readAsDataURL(e),s.onload=function(){localStorage.setItem(t,s.result),a.images={logo:localStorage.getItem("logo"),logoColor:localStorage.getItem("logoColor")}}}},refreshPage:function(t){t&&t.length>0&&localStorage.setItem("baseUrl",t),this.$nextTick((function(){return window.location.reload()}))},loadSettings:function(e){var a=this;console.log("Load Settings"),this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/").concat(this.table,"?_page=1&_sort=id&_order=desc&_limit=1"),void 0,e?{headers:{Authorization:"Basic ".concat(t.from(this.user+":"+this.password).toString("base64"))}}:void 0).then((function(t){t.headers["x-total-count"]>0&&(a.$global.data.settings=Object.assign({},a.$global.data.settings,t.data.pop())),setTimeout((function(){a.$global.data.users={name:a.settings.email,password:a.settings.password},a.password=void 0,a.$refs.userInputRef&&a.$refs.userInputRef.focus(),a.isLoaded=!0,a.initialWebsocket(),a.$q.loading.hide(),a.showAuthentication=!1}),1e3)})).catch((function(t){a.$q.loading.hide(),t.response&&401!==t.response.status&&(console.error(t),a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)}))}))},appendLogs:function(t){this.logs.length>=m&&this.logs.splice(-1,1),this.logs.splice(0,0,"[".concat((new Date).toLocaleString(),"] ").concat(t))},initialWebsocket:function(){this.$wsClient.open("".concat(this.$global.data.baseUrl.replace(/^http/,"ws"))),this.$wsClient.onmessage=function(t,e){var a=JSON.parse(t.data||"{}");if("LOG"===a.type)this.appendLogs(a.data);else if("ERROR"===a.type)console.error(a.data),this.appendLogs(a.data);else if("SCRIPT"===a.type&&a.data)setTimeout(a.data,1e3);else if(a.request&&h.includes(a.request.method)){var s=a.request.path.split("/"),n=i()(s,3),o=n[1],l=n[2];"api"!==o&&(l=o),"db"===l?this.refreshPage():("settings"===l&&(this.$global.data.settings=Object.assign({},this.$global.data.settings,a.response.body)),this.$global.data.modify={request:a.request,response:a.response})}else a&&"undefined"!==a&&"null"!==a&&console.log("UNKNOWN:",a)}.bind(this),this.$wsClient.onclose=function(t){1e3===t.code?console.log("WebSocketClient:",t.status):console.error("Error:",t.status);var e=1e4;console.log("WebSocketClient: Reconnect in ".concat(e," ms"),t),setTimeout(function(){console.log("WebSocketClient: reconnecting..."),this.loadSettings()}.bind(this),e)}.bind(this)},requestBroadcast:function(t){this.$wsClient.send(JSON.stringify({eval:"global.$wsServer.broadcast(JSON.stringify(".concat(JSON.stringify(t),"))")}))},requestBroadcastScript:function(t){this.requestBroadcast({type:"SCRIPT",data:t})},importDatabase:function(){var t=this;this.importFile&&(this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.importFile.text().then((function(e){t.$jsonFetch.post("".concat(t.$global.data.baseUrl,"/db"),JSON.parse(e)).then((function(e){t.$q.loading.hide(),t.$q.notify({type:"positive",message:"ข้อมูลทั้งหมดในระบบฐานข้อมูลได้รับการแทนที่ข้อมูลเดิมเรียบร้อยแล้ว"})})).catch((function(e){t.$q.loading.hide(),console.error(e),t.$emit("error","Error ".concat(e.message)),t.$q.notify({type:"negative",message:"Error ".concat(e.message)})}))})).catch((function(e){t.$q.loading.hide(),console.error(e),t.$emit("error","Error ".concat(e.message)),t.$q.notify({type:"negative",message:"Error ".concat(e.message)})})))},exportDatabase:function(){var t=this;this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/db")).then((function(e){var a=document.createElement("a");a.href=URL.createObjectURL(new Blob([JSON.stringify(e.data,null,2)],{type:"text/plain"})),a.setAttribute("download","db.json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),t.$nextTick((function(){t.$q.loading.hide()}))})).catch((function(e){t.$q.loading.hide(),console.error(e),t.$emit("error","Error ".concat(e.message)),t.$q.notify({type:"negative",message:"Error ".concat(e.message)})}))},exitProgram:function(){var t=this;console.log("Clear Authorization"),this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/").concat(this.table,"?_page=1&_sort=id&_order=desc&_limit=1"),void 0,{headers:{Authorization:"Bearer ="}}).then((function(e){t.refreshPage()})).catch((function(e){t.refreshPage()}))},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}},keepAwake:function(){var t=this,e=this.getRandomIntInclusive(3,5);setTimeout((function(e){t.$jsonFetch.get("".concat(t.baseUrl)).then((function(t){console.log(t,e)})).catch((function(t){console.error(t,e)})),t.keepAwake()}),60*e*1e3,e)},getRandomIntInclusive:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1)+t)},setDefaultsNotify:function(){this.$q.notify.setDefaults({classes:"glossy",position:"bottom",icon:"info",html:!0,progress:!0,timeout:1e4,actions:[{icon:"cancel",color:"white"}]})},_debug:function(){var t;(t=console).log.apply(t,arguments)}}}}).call(this,a("1c35").Buffer)},5927:function(t,e,a){},5928:function(t,e,a){},"599a":function(t,e,a){},"5eaa":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"dealersRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"dealers",title:"⭐ ข้อมูลผู้จำหน่าย ⭐",classes:t.settings.classes,columns:t.dealerColumns,onValidateData:t.onValidateData}})],1)},i=[],n=(a("caad"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("ec67")),o=a("1732"),l={name:"PageDealers",data:function(){return{dealerColumns:[{name:"id",label:"รหัสผู้จำหน่าย",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อผู้จำหน่าย",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataDealers:!1}},components:{JsonTable:n["a"]},beforeCreate:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("dealers")&&(this.$global.data.panelModel===this.$options.name?this.$refs.dealersRef.onRequest():this.isRequireLoadDataDealers||(this.isRequireLoadDataDealers=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataDealers&&(this.isRequireLoadDataDealers=!1,this.$refs.dealersRef.onRequest())}},methods:{onValidateData:function(t,e,a){return"address"===a.name||"telephone"===a.name||"email"===a.name||("text"===a.edit.type||"textarea"===a.edit.type||"date"===a.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==a.edit.type&&"decimal"!==a.edit.type||(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0"))}}},r=l,c=a("2877"),d=Object(c["a"])(r,s,i,!1,null,null,null);e["a"]=d.exports},"613c":function(t,e,a){"use strict";a("599a")},"62eb":function(t,e,a){"use strict";a("342fd")},7079:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"productsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=type&_expand=unit",table:"products",title:"⭐ รายการสินค้า ⭐",classes:t.settings.classes,columns:t.productColumns,onInitAddData:t.onInitAddData,onValidateData:t.onValidateData,onBeforeUpdateData:t.onBeforeUpdateData,onAfterUpdateData:t.onAfterUpdateData},scopedSlots:t._u([{key:"header",fn:function(){return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",color:"primary",size:"xs",label:"ประเภท"},on:{click:function(){return t.dialogTypeVisible=!0}}},[a("q-tooltip",{attrs:{"content-class":"bg-primary"}},[t._v("แก้ไขประเภทสินค้า")])],1),a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",color:"secondary",size:"xs",label:"หน่วยนับ"},on:{click:function(){return t.dialogUnitVisible=!0}}},[a("q-tooltip",{attrs:{"content-class":"bg-secondary"}},[t._v("แก้ไขหน่วยนับ")])],1)]},proxy:!0}])}),a("q-dialog",{attrs:{value:t.dialogTypeVisible||t.dialogUnitVisible,persistent:""},on:{input:function(e){return t.dialogTypeVisible=t.dialogUnitVisible=!1}}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.dialogTypeVisible?"⭐ ประเภทสินค้า ⭐":t.dialogUnitVisible?"⭐ หน่วยนับ ⭐":""))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"q-ma-none q-pa-none"},[a("JsonTable",{directives:[{name:"show",rawName:"v-show",value:t.dialogTypeVisible,expression:"dialogTypeVisible"}],ref:"typesRef",staticClass:"q-ma-none q-pa-none",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},rowsPerPage:0,table:"types",title:"⭐ ประเภทสินค้า ⭐",classes:t.settings.classes,columns:t.typeColumns,onValidateData:t.onValidateData}}),a("JsonTable",{directives:[{name:"show",rawName:"v-show",value:t.dialogUnitVisible,expression:"dialogUnitVisible"}],ref:"unitsRef",staticClass:"q-ma-none q-pa-none",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},rowsPerPage:0,table:"units",title:"⭐ หน่วยนับ ⭐",classes:t.settings.classes,columns:t.unitColumns,onValidateData:t.onValidateData}})],1)],1)],1)],1)},i=[],n=(a("99af"),a("caad"),a("b0c0"),a("d3b7"),a("e6cf"),a("ac1f"),a("2532"),a("4d90"),a("1276"),a("498a"),a("ec67")),o=a("1732"),l={name:"PageProducts",data:function(){return{productColumns:[{name:"id",label:"รหัสสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"barcode",label:"บาร์โค้ด",field:"barcode",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"typeId",label:"ประเภทสินค้า",field:"typeId",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"unitId",label:"หน่วยนับ",field:"unitId",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อสินค้า",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"cost",label:"ราคาทุน",field:"cost",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคาขาย",field:"price",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"คงเหลือ",field:"quantity",sortable:!0,classes:"text-green-10 text-weight-bold",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],typeColumns:[{name:"id",label:"รหัสประเภท",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ประเภทสินค้า",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"detail",label:"รายละเอียด",field:"detail",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],unitColumns:[{name:"id",label:"รหัสหน่วยนับ",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"หน่วยนับ",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"detail",label:"รายละเอียด",field:"detail",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataProducts:!1,isRequireLoadDataTypes:!1,isRequireLoadDataUnits:!1,dialogTypeVisible:!1,dialogUnitVisible:!1,dialogPos:{x:0,y:0}}},components:{JsonTable:n["a"]},beforeCreate:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)"),minWidth:"fit-content"}}},watch:{"$global.data.modify":function(t,e){t.request&&(t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("products")?this.$global.data.panelModel===this.$options.name?this.$refs.productsRef.onRequest():this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0):t.request.path.split("/").includes("types")?this.$global.data.panelModel===this.$options.name?(this.$refs.typesRef.onRequest(),this.$refs.productsRef.onRequest()):(this.isRequireLoadDataTypes||(this.isRequireLoadDataTypes=!0),this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0)):t.request.path.split("/").includes("units")&&(this.$global.data.panelModel===this.$options.name?(this.$refs.unitsRef.onRequest(),this.$refs.productsRef.onRequest()):(this.isRequireLoadDataUnits||(this.isRequireLoadDataUnits=!0),this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0))))},"$global.data.panelModel":function(t,e){t===this.$options.name&&(this.isRequireLoadDataProducts&&(this.isRequireLoadDataProducts=!1,this.$refs.productsRef.onRequest()),this.isRequireLoadDataTypes&&(this.isRequireLoadDataTypes=!1,this.$refs.typesRef.onRequest()),this.isRequireLoadDataUnits&&(this.isRequireLoadDataUnits=!1,this.$refs.unitsRef.onRequest()))},dialogTypeVisible:function(t,e){var a=this;t&&this.$nextTick((function(){var t=a.$refs.typesRef.$el.querySelector("div.q-table__middle");t&&(t.style.maxHeight="fit-content")}))},dialogUnitVisible:function(t,e){var a=this;t&&this.$nextTick((function(){var t=a.$refs.unitsRef.$el.querySelector("div.q-table__middle");t&&(t.style.maxHeight="fit-content")}))}},methods:{onInitAddData:function(t){t.barcode=""},onValidateData:function(t,e,a){return"barcode"===a.name||"detail"===a.name||("typeId"===a.name||"unitId"===a.name||"text"===a.edit.type||"textarea"===a.edit.type||"date"===a.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==a.edit.type&&"decimal"!==a.edit.type||(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0"))},onBeforeUpdateData:function(t,e,a){e.price||(e.price=Math.round(e.cost+e.cost*this.settings.profit/100))},onAfterUpdateData:function(t,e,a,s){var i=this;if(e.barcode=e.barcode.trim(),!e.barcode)return new Promise((function(t,a){var s={id:e.id,barcode:"".concat(e.id).padStart(13,"0")};e.barcode=s.barcode,i.$jsonFetch.patch("".concat(i.$global.data.baseUrl,"/products/").concat(e.id),s,{params:{uid:i.UID}}).then((function(a){t(),i.$emit("update-cell","products",e,"barcode",a.data)})).catch((function(t){a(t)}))}))},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}}}},r=l,c=(a("7744"),a("2877")),d=a("9c40"),u=a("05c0"),p=a("24e8"),f=a("f09f"),h=a("a370"),m=a("d847"),g=a("2c91"),b=a("eaac"),y=a("75c3"),_=a("7f67"),v=a("eebe"),x=a.n(v),w=Object(c["a"])(r,s,i,!1,null,"30239160",null);e["a"]=w.exports;x()(w,"components",{QBtn:d["a"],QTooltip:u["a"],QDialog:p["a"],QCard:f["a"],QCardSection:h["a"],QBar:m["a"],QSpace:g["a"],QTable:b["a"]}),x()(w,"directives",{TouchPan:y["a"],ClosePopup:_["a"]})},"713b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{attrs:{view:"hHh lpR fFf"}},[a("q-header",{staticClass:"bg-primary text-white",attrs:{elevated:"","height-hint":"98"}},[a("q-toolbar",{staticClass:"bg-primary glossy text-white"},[a("q-fab",{attrs:{dense:"",flat:"",round:"",square:"",direction:"down","vertical-actions-align":"left",icon:"menu"},model:{value:t.menuModel,callback:function(e){t.menuModel=e},expression:"menuModel"}},[a("q-fab-action",{attrs:{glossy:"",square:"",color:"light-blue",label:"ขายสินค้า","label-position":"right",icon:"point_of_sale"},on:{click:function(e){t.panelModel="PageSales"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"cyan",label:"ซื้อสินค้า","label-position":"right",icon:"shopping_cart"},on:{click:function(e){t.panelModel="PagePurchases"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"teal",label:"ข้อมูลลูกค้า","label-position":"right",icon:"people"},on:{click:function(e){t.panelModel="PageCustomers"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"secondary",label:"ข้อมูลผู้จำหน่าย","label-position":"right",icon:"people_outline"},on:{click:function(e){t.panelModel="PageDealers"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"positive",label:"รายการสินค้า","label-position":"right",icon:"widgets"},on:{click:function(e){t.panelModel="PageProducts"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"accent",label:"พิมพ์บาร์โค้ด","label-position":"right",icon:"qr_code"},on:{click:function(e){t.panelModel="PagePrintBarcode"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"pink",label:"ประมวลผลข้อมูล","label-position":"right",icon:"auto_graph"},on:{click:function(e){t.panelModel="PageSummary"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"negative",label:"การตั้งค่า","label-position":"right",icon:"settings"},on:{click:function(e){t.panelModel="PageSettings"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"deep-orange",label:"ปิดระบบ","label-position":"right",icon:"power_settings_new"},on:{click:function(e){t.exitDialog=!0}}})],1),a("q-toolbar-title",[t._v("\n        "+t._s(t.settings.name)+"\n      ")]),a("q-btn-group",{attrs:{push:""}},[a("q-btn",{attrs:{glossy:"",color:"light-blue",icon:"point_of_sale"},on:{click:function(e){t.panelModel="PageSales"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-light-blue","content-style":"font-size: 14px;"}},[t._v("\n            ขายสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"cyan",icon:"shopping_cart"},on:{click:function(e){t.panelModel="PagePurchases"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-cyan","content-style":"font-size: 14px;"}},[t._v("\n            ซื้อสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"teal",icon:"people"},on:{click:function(e){t.panelModel="PageCustomers"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-teal","content-style":"font-size: 14px;"}},[t._v("\n            ข้อมูลลูกค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"secondary",icon:"people_outline"},on:{click:function(e){t.panelModel="PageDealers"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-secondary","content-style":"font-size: 14px;"}},[t._v("\n            ข้อมูลผู้จำหน่าย\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"positive",icon:"widgets"},on:{click:function(e){t.panelModel="PageProducts"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-positive","content-style":"font-size: 14px;"}},[t._v("\n            รายการสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"accent",icon:"qr_code"},on:{click:function(e){t.panelModel="PagePrintBarcode"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-accent","content-style":"font-size: 14px;"}},[t._v("\n            พิมพ์บาร์โค้ด\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"pink",icon:"auto_graph"},on:{click:function(e){t.panelModel="PageSummary"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-pink","content-style":"font-size: 14px;"}},[t._v("\n            ประมวลผลข้อมูล\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"negative",icon:"settings"},on:{click:function(e){t.panelModel="PageSettings"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-negative","content-style":"font-size: 14px;"}},[t._v("\n            การตั้งค่า\n          ")])],1),a("q-btn-dropdown",{attrs:{glossy:"",color:"deep-orange","dropdown-icon":"handyman"},scopedSlots:t._u([{key:"label",fn:function(){return[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-deep-orange","content-style":"font-size: 14px;"}},[t._v("\n              เครื่องมือ\n            ")])]},proxy:!0}])},[a("q-list",[a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.eventDialog=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"primary","text-color":"white",icon:"help"}})],1),a("q-item-section",[a("q-item-label",[t._v("รายงานเหตุการณ์")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.showSetJsonServer=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"teal","text-color":"white",icon:"power"}})],1),a("q-item-section",[a("q-item-label",[t._v("การเชื่อมต่อข้อมูล")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.exportDialog=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"positive","text-color":"white",icon:"cloud_download"}})],1),a("q-item-section",[a("q-item-label",[t._v("ส่งออกฐานข้อมูล")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.$refs.importFileRef.$el.click()}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"negative","text-color":"white",icon:"cloud_upload"}})],1),a("q-item-section",[a("q-item-label",[t._v("นำเข้าฐานข้อมูล")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.exitDialog=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"deep-orange","text-color":"white",icon:"power_settings_new"}})],1),a("q-item-section",[a("q-item-label",[t._v("ปิดระบบ")])],1)],1)],1)],1)],1)],1)],1),a("q-page-container",[a("keep-alive",[t.isLoaded?a("q-tab-panels",{attrs:{animated:"","keep-alive":""},model:{value:t.panelModel,callback:function(e){t.panelModel=e},expression:"panelModel"}},[a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageSales"}},[a("keep-alive",[a("Sales")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PagePurchases"}},[a("keep-alive",[a("Purchases")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageCustomers"}},[a("keep-alive",[a("Customers")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageDealers"}},[a("keep-alive",[a("Dealers")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageProducts"}},[a("keep-alive",[a("Products")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PagePrintBarcode"}},[a("keep-alive",[a("PrintBarcode")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageSummary"}},[a("keep-alive",[a("Summary")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageSettings"}},[a("keep-alive",[a("Settings")],1)],1)],1):t._e()],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.showSetJsonServer,callback:function(e){t.showSetJsonServer=e},expression:"showSetJsonServer"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"500px"}},[a("q-input",{ref:"baseUrlInputRef",attrs:{type:"text",autofocus:"",clearable:"",counter:"","stack-label":"",debounce:"1000",label:"URL ของระบบฐานข้อมูล","input-class":"text-primary",rules:[function(t){return t&&t.length>0||"ยังไม่ได้กำหนดข้อมูล"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(){return t.refreshPage(t.baseUrl)}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.baseUrl=t.$global.data.baseUrl.replace(/\/api$/,""),t.$nextTick((function(){return t.$refs.baseUrlInputRef.resetValidation()}))}},model:{value:t.baseUrl,callback:function(e){t.baseUrl=e},expression:"baseUrl"}}),a("q-file",{attrs:{label:"โลโก้ แบบไม่มีสี"},on:{input:function(e){return t.setLocalStorageFromFile("logo",e)}},scopedSlots:t._u([{key:"default",fn:function(){return[a("img",{attrs:{src:t.images.logo,width:"80"}})]},proxy:!0}])}),a("q-file",{attrs:{label:"โลโก้ แบบมีสี"},on:{input:function(e){return t.setLocalStorageFromFile("logoColor",e)}},scopedSlots:t._u([{key:"default",fn:function(){return[a("img",{attrs:{src:t.images.logoColor,width:"80"}})]},proxy:!0}])})],1)]),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{attrs:{color:"primary",label:"ตกลง",disable:!(t.baseUrl&&t.baseUrl.length>0)},on:{click:function(e,a){return t.refreshPage(t.baseUrl)}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.showAuthentication,callback:function(e){t.showAuthentication=e},expression:"showAuthentication"}},[a("q-card",{staticStyle:{background:"radial-gradient(circle at center, rgba(255, 255, 255, 1.0), rgba(80, 160, 240, 0.8))"}},[a("q-card-section",{staticClass:"q-pa-none",attrs:{align:"evenly"}},[a("div",{staticClass:"q-pb-none",attrs:{align:"center"}},[a("img",{attrs:{src:t.images.logoColor,width:"300"}})])]),a("q-card-section",[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"500px"}},[a("q-input",{ref:"userInputRef",attrs:{type:"email",autofocus:"",clearable:"",counter:"","stack-label":"",debounce:"1000",label:"อีเมล์","input-class":"text-center text-accent text-h4",rules:[function(t){return t&&t.length>0&&t.includes("@")||"ยังไม่ได้กำหนดข้อมูล อีเมล์"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(){return t.$refs.passwordInputRef.focus()}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.user=void 0,t.$nextTick((function(){return t.$refs.userInputRef.resetValidation()}))}},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}),a("q-input",{ref:"passwordInputRef",attrs:{type:"password",clearable:"",counter:"","stack-label":"",debounce:"1000",label:"รหัสผ่าน","input-class":"text-center text-accent text-h4",rules:[function(t){return!t||t&&t.length>=0||"ยังไม่ได้กำหนดข้อมูล รหัสผ่าน"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(){return t.user&&t.user.length>0&&(!t.password||t.password&&t.password.length>=0)&&t.loadSettings(!0)}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.password=void 0,t.$nextTick((function(){return t.$refs.passwordInputRef.resetValidation()}))}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)]),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{attrs:{color:"primary",label:"เปิดใช้งาน",disable:!(t.user&&t.user.length>0&&(!t.password||t.password&&t.password.length>=0))},on:{click:function(e,a){return t.loadSettings(!0)}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale","full-width":""},model:{value:t.eventDialog,callback:function(e){t.eventDialog=e},expression:"eventDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("span",{staticClass:"q-ml-sm",staticStyle:{"white-space":"pre"}},[t._v(t._s(t.log))])])],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.exportDialog,callback:function(e){t.exportDialog=e},expression:"exportDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{color:"positive","text-color":"white",icon:"cloud_download"}}),a("span",{staticClass:"q-ml-sm"},[t._v("กรุณายืนยันการส่งออกไฟล์ฐานข้อมูล (db.json)")]),a("span",{staticClass:"q-ml-sm"},[t._v("(คำแนะนำ) ข้อมูลทั้งหมดในระบบฐานข้อมูลจะได้รับการส่งออกไปบันทึกไว้ในไฟล์ db.json")])],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ยกเลิก"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ตกลง"},on:{click:function(e){return t.exportDatabase()}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},on:{hide:function(e){t.importFile=void 0}},model:{value:t.importDialog,callback:function(e){t.importDialog=e},expression:"importDialog"}},[a("q-card",{staticClass:"bg-negative text-white",style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{color:"warning","text-color":"white",icon:"cloud_upload"}}),a("span",{staticClass:"q-ml-sm"},[t._v("กรุณายืนยันการนำเข้าไฟล์ฐานข้อมูล (db.json)")]),a("span",{staticClass:"q-ml-sm"},[t._v("(คำเตือน) ข้อมูลทั้งหมดในระบบฐานข้อมูลจะได้รับการแทนที่ข้อมูลเดิมจากการนำเข้าของไฟล์ db.json")])],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ยกเลิก"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ตกลง"},on:{click:function(e){return t.importDatabase()}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.exitDialog,callback:function(e){t.exitDialog=e},expression:"exitDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{color:"deep-orange","text-color":"white",icon:"power_settings_new"}}),a("span",{staticClass:"q-ml-sm"},[t._v("กรุณายืนยันการปิดระบบ")])],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ยกเลิก"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ตกลง"},on:{click:function(e){return t.exitProgram()}}})],1)],1)],1),a("q-file",{ref:"importFileRef",staticClass:"hidden",attrs:{accept:".json, application/json"},on:{input:function(e){t.importDialog=!0}},model:{value:t.importFile,callback:function(e){t.importFile=e},expression:"importFile"}})],1)},i=[],n=a("49de"),o=n["a"],l=(a("62eb"),a("2877")),r=a("4d5a"),c=a("e359"),d=a("65c6"),u=a("c294"),p=a("72db"),f=a("6ac5"),h=a("cb32"),m=a("e7a9"),g=a("9c40"),b=a("05c0"),y=a("f20b"),_=a("1c1c"),v=a("66e5"),x=a("4074"),w=a("0170"),q=a("09e3"),D=a("adad"),C=a("823b"),R=a("7ff0"),P=a("24e8"),$=a("f09f"),S=a("a370"),k=a("d847"),V=a("2c91"),I=a("27f9"),F=a("7d53"),U=a("4b7e"),L=a("7f67"),T=a("75c3"),E=a("eebe"),j=a.n(E),Q=Object(l["a"])(o,s,i,!1,null,"e544d38a",null);e["default"]=Q.exports;j()(Q,"components",{QLayout:r["a"],QHeader:c["a"],QToolbar:d["a"],QFab:u["a"],QFabAction:p["a"],QToolbarTitle:f["a"],QAvatar:h["a"],QBtnGroup:m["a"],QBtn:g["a"],QTooltip:b["a"],QBtnDropdown:y["a"],QList:_["a"],QItem:v["a"],QItemSection:x["a"],QItemLabel:w["a"],QPageContainer:q["a"],QTabPanels:D["a"],QTabPanel:C["a"],QFooter:R["a"],QDialog:P["a"],QCard:$["a"],QCardSection:S["a"],QBar:k["a"],QSpace:V["a"],QInput:I["a"],QFile:F["a"],QCardActions:U["a"]}),j()(Q,"directives",{ClosePopup:L["a"],TouchPan:T["a"]})},7744:function(t,e,a){"use strict";a("5927")},"7d5b":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"customersRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"customers",title:"⭐ ข้อมูลลูกค้า ⭐",classes:t.settings.classes,columns:t.customerColumns,onValidateData:t.onValidateData}})],1)},i=[],n=(a("caad"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("ec67")),o=a("1732"),l={name:"PageCustomers",data:function(){return{customerColumns:[{name:"id",label:"รหัสลูกค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อลูกค้า",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataCustomers:!1}},components:{JsonTable:n["a"]},beforeCreate:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("customers")&&(this.$global.data.panelModel===this.$options.name?this.$refs.customersRef.onRequest():this.isRequireLoadDataCustomers||(this.isRequireLoadDataCustomers=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataCustomers&&(this.isRequireLoadDataCustomers=!1,this.$refs.customersRef.onRequest())}},methods:{onValidateData:function(t,e,a){return"address"===a.name||"telephone"===a.name||"email"===a.name||("text"===a.edit.type||"textarea"===a.edit.type||"date"===a.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==a.edit.type&&"decimal"!==a.edit.type||(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0"))}}},r=l,c=a("2877"),d=Object(c["a"])(r,s,i,!1,null,null,null);e["a"]=d.exports},acfe:function(t,e,a){"use strict";a("5928")},caa3:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"productsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=type&_expand=unit",table:"products",title:"⭐ รายการสินค้า - พิมพ์บาร์โค้ด ⭐",classes:t.settings.classes,columns:t.productColumns.filter((function(t){return"printsPerItem"!==t.name})),hideAddButton:"",hideEditButton:"",hideRemoveButton:""},scopedSlots:t._u([{key:"body",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"add",color:"orange",size:"xs"},on:{click:function(){return t.addSelectedItem(s.row)}}},[a("q-tooltip",{attrs:{"content-class":"bg-orange"}},[t._v("เพิ่มรายการพิมพ์บาร์โค้ด")])],1)]}}])}),a("JsonTable",{attrs:{title:"⭐ รายการพิมพ์บาร์โค้ด "+t.selectedItems.length+" รายการ ⭐",classes:t.settings.classes,columns:t.productColumns,hideSearchButton:"",hideRefreshButton:"",hideAddButton:"",hideEditButton:"",hideRemoveButton:"",hidePagination:""},on:{"update-cell":function(e,a,s){return t.renderBarcode(!0)}},scopedSlots:t._u([{key:"header",fn:function(e){var s=e.props;return[a("q-checkbox",{attrs:{label:"แสดงชื่อสินค้า"},model:{value:t.displayName,callback:function(e){t.displayName=e},expression:"displayName"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-checkbox",{attrs:{label:"แสดงราคาสินค้า"},model:{value:t.displayPrice,callback:function(e){t.displayPrice=e},expression:"displayPrice"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-checkbox",{attrs:{label:"แสดงบาร์โค้ด"},model:{value:t.displayBarcode,callback:function(e){t.displayBarcode=e},expression:"displayBarcode"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"ความกว้างของบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=200||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.barcodeWidth=150}},model:{value:t.barcodeWidth,callback:function(e){t.barcodeWidth=t._n(e)},expression:"barcodeWidth"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("ความกว้างของบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"ความสูงของบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=200||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.barcodeHeight=40}},model:{value:t.barcodeHeight,callback:function(e){t.barcodeHeight=t._n(e)},expression:"barcodeHeight"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("ความสูงของบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"จำนวนบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=100||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.printsPerItem=1}},model:{value:t.printsPerItem,callback:function(e){t.printsPerItem=t._n(e)},expression:"printsPerItem"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("จำนวนบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"print",color:"accent",size:"xs",disable:t.selectedItems<=0},on:{click:function(){return t.printAllSelectedItem(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-accent"}},[t._v("พิมพ์บาร์โค้ด")])],1),a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"clear",color:"red",size:"xs",disable:t.selectedItems<=0},on:{click:function(){return t.removeAllSelectedItem(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบรายการทั้งหมด")])],1)]}},{key:"body",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"remove",color:"red",size:"xs"},on:{click:function(){return t.removeSelectedItem(s.row)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบรายการพิมพ์บาร์โค้ด")])],1)]}}]),model:{value:t.selectedItems,callback:function(e){t.selectedItems=e},expression:"selectedItems"}}),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},[t.selectedItems.length>0?a("div",{staticClass:"q-pa-md row wrap justify-start items-end content-start",staticStyle:{width:"780px",border:"1px solid black"},attrs:{id:"printBorder"}},t._l(t.barcodeItems,(function(e){return a("div",{key:e.key,staticClass:"q-pa-xs text-center",staticStyle:{overflow:"auto"}},[t.displayName?a("div",{staticClass:"text-bold",style:"width: "+t.barcodeWidth+"px;"},[t._v(t._s(e.name)+"\n        ")]):t._e(),t.displayPrice?a("div",{staticClass:"text-bold",staticStyle:{"font-size":"larger"}},[t._v(t._s((+e.price||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" "+t._s("บาท")+"\n        ")]):t._e(),a("svg",{class:"class-"+e.id})])})),0):t._e()])],1)},i=[],n=(a("99af"),a("c740"),a("4160"),a("caad"),a("13d5"),a("a434"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("ec67")),o=a("1732"),l=a("a57a"),r=a.n(l),c={name:"PagePrintBarcode",data:function(){return{productColumns:[{name:"id",label:"รหัสสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"barcode",label:"บาร์โค้ด",field:"barcode",sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"typeId",label:"ประเภทสินค้า",field:"typeId",sortable:!0,classes:"text-center",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"unitId",label:"หน่วยนับ",field:"unitId",sortable:!0,classes:"text-center",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อสินค้า",field:"name",sortable:!0,classes:"text-left",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"cost",label:"ราคาทุน",field:"cost",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคาขาย",field:"price",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"คงเหลือ",field:"quantity",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"printsPerItem",label:"จำนวนบาร์โค้ด",field:"printsPerItem",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],selectedItems:[],isRequireLoadDataProducts:!1,displayName:!0,displayPrice:!0,displayBarcode:!0,barcodeWidth:150,barcodeHeight:40,printsPerItem:1}},components:{JsonTable:n["a"]},beforeCreate:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}},barcodeItems:function(){var t=this;return this.selectedItems.reduce((function(e,a){for(var s=1;s<=a.printsPerItem;s++)e.push(Object.assign({},a,{key:"".concat(a.id,"-").concat(s)}));return t.renderBarcode(),e}),[])}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("products")||t.request.path.split("/").includes("types")||t.request.path.split("/").includes("units"))&&(this.$global.data.panelModel===this.$options.name?this.$refs.productsRef.onRequest():this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataProducts&&(this.isRequireLoadDataProducts=!1,this.$refs.productsRef.onRequest())},displayBarcode:function(t,e){this.renderBarcode(!0)},barcodeWidth:function(t,e){this.setBarcodeWidth()},barcodeHeight:function(t,e){this.renderBarcode(!0)}},methods:{addSelectedItem:function(t){if(t){var e=this.selectedItems.findIndex((function(e){return e.id===t.id}));e>=0?(this.selectedItems.splice(e,1,t),t.printsPerItem=(t.printsPerItem||0)+this.printsPerItem):(this.selectedItems.splice(this.selectedItems.length,0,t),this.$set(t,"printsPerItem",this.printsPerItem)),t.hasRender=!1}},removeSelectedItem:function(t){if(t){var e=this.selectedItems.findIndex((function(e){return e.id===t.id}));e>=0&&this.selectedItems.splice(e,1)}},removeAllSelectedItem:function(t){t&&this.selectedItems.splice(0,this.selectedItems.length)},printAllSelectedItem:function(t){var e=this;t&&this.selectedItems.length>0&&(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return e.printBorderVisibility(!0)})))},selectOnFocus:function(t){t&&t.target&&"function"===typeof t.target.select&&t.target.select()},setBarcodeWidth:function(){var t=this;this.$nextTick((function(){document.querySelectorAll("svg[class^=class-]").forEach((function(e){e.setAttribute("width",t.barcodeWidth),e.removeAttribute("height")}))}))},renderBarcode:function(t){var e=this;this.$nextTick((function(){e.selectedItems.length>0&&(e.selectedItems.forEach((function(a){(!0===t||!a.hasRender&&(a.hasRender=!0))&&r()(".class-".concat(a.id),a.barcode,{format:"CODE128",font:"Sarabun",fontOptions:"bold",fontSize:20,margin:10,textMargin:2,width:2,height:e.barcodeHeight,displayValue:e.displayBarcode}).render()})),e.setBarcodeWidth())}))},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"}}},d=c,u=a("2877"),p=a("9c40"),f=a("05c0"),h=a("8f8e"),m=a("2c91"),g=a("27f9"),b=a("eebe"),y=a.n(b),_=Object(u["a"])(d,s,i,!1,null,null,null);e["a"]=_.exports;y()(_,"components",{QBtn:p["a"],QTooltip:f["a"],QCheckbox:h["a"],QSpace:m["a"],QInput:g["a"]})},ec67:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-md"},[a("q-table",{attrs:{"binary-state-sort":"","row-key":"id",selection:"single",separator:"cell",title:t.title,data:t.data,pagination:t.pagination,loading:t.loading,columns:t.columns,filter:t.filter,"hide-pagination":t.hidePagination,"table-class":["sticky-column-table",t.classes||""],"table-header-class":["sticky-column-table","text-bold",t.headerClasses||t.classes||""],"title-class":["text-bold",t.headerClasses||t.classes||""],selected:t.selectedRows},on:{"update:title":function(e){t.title=e},"update:data":function(e){t.data=e},"update:pagination":function(e){t.pagination=e},"update:loading":function(e){t.loading=e},"update:columns":function(e){t.columns=e},"update:filter":function(e){t.filter=e},"update:hidePagination":function(e){t.hidePagination=e},"update:hide-pagination":function(e){t.hidePagination=e},"update:selected":function(e){t.selectedRows=e},request:function(e){return t.onRequest(e)}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[t.hideSearchButton?t._e():a("q-input",{attrs:{dense:"",clearable:"",debounce:"1000",placeholder:"ค้นหา"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}}),a("q-tooltip",{attrs:{"content-class":"bg-purple"}},[t._v("ค้นหาข้อมูล")])]},proxy:!0}],null,!0),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t.hideRefreshButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"refresh",color:"green",size:"xs"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),function(){return t.onRequest(t.initialPagination)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("รีเฟรชข้อมูล")])],1),t.hideAddButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"add",color:"orange",size:"xs"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),function(){return t.addRow()}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-orange"}},[t._v("เพิ่มข้อมูล")])],1),t._t("header",null,{props:e})]}},{key:"header",fn:function(e){return[a("q-tr",{attrs:{props:e}},[t.showSelectedRows?a("q-th",{class:["text-bold bg-grey-5",t.headerClasses||t.classes||""],staticStyle:{"text-align":"center"},attrs:{"auto-width":!0}}):t._e(),t._l(e.cols,(function(s){return a("q-th",{key:s.name,class:["text-bold bg-grey-4",t.headerClasses||t.classes||"",s.headerClasses||""],staticStyle:{"text-align":"center"},attrs:{props:e,"auto-width":!0}},[a("span",{class:["text-bold bg-grey-4",t.headerClasses||t.classes||"",s.headerClasses||""]},[t._v("\n            "+t._s(s.label)+"\n          ")])])})),a("q-dialog",{ref:"editDialogRef",attrs:{persistent:""},on:{input:function(e){return t.dialogVisible=e}}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.title))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"q-px-xl"},t._l(e.cols,(function(e){return a("div",{key:e.name},["text"===e.edit.type||"textarea"===e.edit.type||"password"===e.edit.type?a("div",[e.edit.readonly?t._e():a("q-input",{ref:e.name+"-ref",refInFor:!0,attrs:{type:e.edit.type,dense:"",counter:"","stack-label":"",label:e.label,readonly:e.edit.readonly,"input-class":e.edit.inputClass,prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateData(a,t.editedRow,e,!0)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:(a.preventDefault(),a.stopPropagation(),function(a){return t.dialogInputEnterKey(a,e.name+"-ref")}(a))}},model:{value:t.editedRow[e.name],callback:function(a){t.$set(t.editedRow,e.name,a)},expression:"editedRow[col.name]"}})],1):t._e(),"number"===e.edit.type||"decimal"===e.edit.type?a("div",[e.name.endsWith("Id")?a("div",[!e.edit.readonly||t.isNewRow?a("q-select",{ref:e.name+"-ref",refInFor:!0,attrs:{dense:"",counter:"","stack-label":"",label:e.label,readonly:e.edit.readonly&&!t.isNewRow,"input-class":e.edit.inputClass||"text-right","input-debounce":1e3,prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateData(a,t.editedRow,e,!0)}],options:t.filterOptions[e.name.slice(0,-2)+"s"],"option-label":function(a){return"function"===typeof e.edit.optionLabel?e.edit.optionLabel(a):"string"===typeof e.edit.optionLabel?e.edit.optionLabel:(t.editedRow[e.name.slice(0,-2)]||{name:""}).name},"option-value":"id","emit-value":"","map-options":"","use-input":"","fill-input":"","hide-selected":""},on:{filter:function(a,s,i){return t.filterFnAutoSelect(a,s,i,e.name.slice(0,-2)+"s")},"filter-abort":t.abortFilterFn,input:function(a){return t.editedRow[""+e.name.slice(0,-2)]=t.filterOptions[e.name.slice(0,-2)+"s"].find((function(t){return t.id===a})),t.$emit("input-select",t.editedRow,e)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:(a.preventDefault(),a.stopPropagation(),function(a){return t.dialogInputEnterKey(a,e.name+"-ref")}(a))}},scopedSlots:t._u([{key:"option",fn:function(s){var i=s.itemProps,n=s.itemEvents,o=s.opt;return[a("q-item",t._g(t._b({},"q-item",i,!1),n),[a("q-item-section",{attrs:{"no-wrap":""}},[a("q-item-label",{domProps:{innerHTML:t._s(o.name)}})],1),a("q-item-section",{attrs:{side:""}},[a("q-item-label",{domProps:{innerHTML:t._s("function"===typeof e.edit.optionDetail?e.edit.optionDetail(o):"string"===typeof e.edit.optionDetail?e.edit.optionDetail:"")}})],1)],1)]}}],null,!0),model:{value:t.editedRow[e.name],callback:function(a){t.$set(t.editedRow,e.name,t._n(a))},expression:"editedRow[col.name]"}}):t._e()],1):a("div",[e.edit.readonly?t._e():a("q-input",{ref:e.name+"-ref",refInFor:!0,attrs:{type:"number",dense:"",counter:"","stack-label":"",label:e.label,readonly:e.edit.readonly,"input-class":e.edit.inputClass||"text-right",prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return Math.sign(t.editedRow[e.name])<0||t.validateData(a,t.editedRow,e,!0)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:[function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:(a.preventDefault(),a.stopPropagation(),function(a){return t.dialogInputEnterKey(a,e.name+"-ref")}(a))},function(a){return a.preventDefault(),a.stopPropagation(),function(a){return t.changePercentage(a,t.editedRow,e)}(a)}]},scopedSlots:t._u([{key:"default",fn:function(s){return[Math.sign(t.editedRow[e.name])<0?a("div",t._b({staticClass:"q-field__suffix no-pointer-events row items-center"},"div",s,!1),[t._v("%")]):a("div",t._b({staticClass:"q-field__suffix no-pointer-events row items-center invisible"},"div",s,!1),[t._v("%")])]}}],null,!0),model:{value:t.editedRow[e.name],callback:function(a){t.$set(t.editedRow,e.name,t._n(a))},expression:"editedRow[col.name]"}})],1)]):t._e(),"datetime"===e.edit.type?a("div",[e.edit.readonly?t._e():a("q-input",{ref:e.name+"-ref",refInFor:!0,attrs:{value:t.bindDateTime(t.editedRow[e.name]),type:"datetime-local",dense:"",counter:"","stack-label":"",label:e.label,readonly:e.edit.readonly,"input-class":e.edit.inputClass,prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateData(a,t.editedRow,e,!0)}]},on:{input:function(a){return t.editedRow[e.name]=t.eventDateTime(a)},focus:function(e){return t.selectOnFocus(e)},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:(a.preventDefault(),a.stopPropagation(),function(a){return t.dialogInputEnterKey(a,e.name+"-ref")}(a))}}})],1):t._e()])})),0),a("q-card-actions",{staticClass:"q-pb-md q-gutter-md row justify-evenly"},[a("q-btn",{attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),function(){return t.setShowEditDialog(!1)}()}}}),a("q-btn",{attrs:{glossy:"",color:"secondary",label:"ตกลง",disable:t.dialogVisible&&(t.buttonValidateDisable||t.shallowCompare(t.editedRow,t.editedRow.__row__))},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),function(){return t.updateRow(t.editedRow)}()}}})],1)],1)],1)],2)]}},{key:"body",fn:function(e){return[a("q-tr",{class:e.row.__class__?e.row.__class__:"",attrs:{props:e}},[t.showSelectedRows?a("q-td",{attrs:{"auto-width":!0}},[a("q-checkbox",{class:[t.classes||""],model:{value:e.selected,callback:function(a){t.$set(e,"selected",a)},expression:"props.selected"}})],1):t._e(),t._l(e.cols,(function(s){return a("q-td",{key:s.name,attrs:{props:e,"auto-width":!0}},[a("div",{class:[t.classes||"",s.classes||""]},["text"===s.edit.type||"textarea"===s.edit.type||"password"===s.edit.type?a("div",[t._v("\n              "+t._s(t.getCellDisplay(e.row,s))+"\n\n              "),s.edit.readonly||e.row.__readonly__?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"text-center text-h6 text-primary",staticStyle:{"text-decoration":"underline"}},[t._v("\n                    "+t._s("แก้ไข"+s.label)+"\n                  ")]),a("q-input",{ref:s.name+"-ref",refInFor:!0,attrs:{type:s.edit.type,autofocus:"",dense:"",counter:"","stack-label":"",label:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass,prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateData(a,e.row,s)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(e){return t.popupEditEnterKey(e)}(e))}},model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",a)},expression:"props.row[`__${col.name}__`]"}}),a("div",{staticClass:"q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"ตกลง",disable:t.popupVisible&&(t.buttonValidateDisable||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1):"number"===s.edit.type||"decimal"===s.edit.type?a("div",[s.name.endsWith("Id")?a("div",[t._v("\n                "+t._s(t.getCellDisplay(e.row,s))+"\n\n                "),s.edit.readonly||e.row.__readonly__?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"text-center text-h6 text-primary",staticStyle:{"text-decoration":"underline"}},[t._v("\n                      "+t._s("แก้ไข"+s.label)+"\n                    ")]),a("q-select",{ref:s.name+"-ref",refInFor:!0,attrs:{autofocus:"",dense:"",counter:"","stack-label":"",label:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass||"text-right","input-debounce":1e3,prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateData(a,e.row,s)}],options:t.filterOptions[s.name.slice(0,-2)+"s"],"option-label":function(t){return"function"===typeof s.edit.optionLabel?s.edit.optionLabel(t):"string"===typeof s.edit.optionLabel?s.edit.optionLabel:(e.row[s.name.slice(0,-2)]||{name:""}).name},"option-value":"id","emit-value":"","map-options":"","use-input":"","fill-input":"","hide-selected":""},on:{filter:function(e,a,i){return t.filterFnAutoSelect(e,a,i,s.name.slice(0,-2)+"s")},"filter-abort":t.abortFilterFn,input:function(a){return t.$emit("input-select",e.row,s)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(e){return t.popupEditEnterKey(e)}(e))}},scopedSlots:t._u([{key:"option",fn:function(e){var i=e.itemProps,n=e.itemEvents,o=e.opt;return[a("q-item",t._g(t._b({},"q-item",i,!1),n),[a("q-item-section",{attrs:{"no-wrap":""}},[a("q-item-label",{domProps:{innerHTML:t._s(o.name)}})],1),a("q-item-section",{attrs:{side:""}},[a("q-item-label",{domProps:{innerHTML:t._s("function"===typeof s.edit.optionDetail?s.edit.optionDetail(o):"string"===typeof s.edit.optionDetail?s.edit.optionDetail:"")}})],1)],1)]}}],null,!0),model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",t._n(a))},expression:"props.row[`__${col.name}__`]"}}),a("div",{staticClass:"q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"ตกลง",disable:t.popupVisible&&(t.buttonValidateDisable||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],e.row[s.name.slice(0,-2)]=t.filterOptions[s.name.slice(0,-2)+"s"].find((function(t){return t.id===e.row[s.name]})),t.updateCell(e.row,s)}()}}})],1)],1)])],1):a("div",[t._v("\n                "+t._s(t.getCellDisplay(e.row,s))+"\n\n                "),s.edit.readonly||e.row.__readonly__?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"text-center text-h6 text-primary",staticStyle:{"text-decoration":"underline"}},[t._v("\n                      "+t._s("แก้ไข"+s.label)+"\n                    ")]),a("q-input",{ref:s.name+"-ref",refInFor:!0,attrs:{type:"number",autofocus:"",dense:"",counter:"","stack-label":"",label:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass||"text-right",prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return Math.sign(e.row["__"+s.name+"__"])<0||t.validateData(a,e.row,s)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(e){return t.popupEditEnterKey(e)}(e))},function(a){return a.preventDefault(),a.stopPropagation(),function(a){return t.changePercentage(a,e.row,s)}(a)}]},scopedSlots:t._u([{key:"default",fn:function(i){return[Math.sign(e.row["__"+s.name+"__"])<0?a("div",t._b({staticClass:"q-field__suffix no-pointer-events row items-center"},"div",i,!1),[t._v("%")]):a("div",t._b({staticClass:"q-field__suffix no-pointer-events row items-center invisible"},"div",i,!1),[t._v("%")])]}}],null,!0),model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",t._n(a))},expression:"props.row[`__${col.name}__`]"}}),a("div",{staticClass:"q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"ตกลง",disable:t.popupVisible&&(t.buttonValidateDisable||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1)]):t._e(),"datetime"===s.edit.type?a("div",[t._v("\n              "+t._s(t.getCellDisplay(e.row,s))+"\n\n              "),s.edit.readonly||e.row.__readonly__?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"text-center text-h6 text-primary",staticStyle:{"text-decoration":"underline"}},[t._v("\n                    "+t._s("แก้ไข"+s.label)+"\n                  ")]),a("q-input",{ref:s.name+"-ref",refInFor:!0,attrs:{value:t.bindDateTime(e.row["__"+s.name+"__"]),type:"datetime-local",autofocus:"",dense:"",counter:"","stack-label":"",label:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass,prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateData(a,e.row,s)}]},on:{input:function(a){return e.row["__"+s.name+"__"]=t.eventDateTime(a)},focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(e){return t.popupEditEnterKey(e)}(e))}}}),a("div",{staticClass:"q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.preventDefault(),t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"ตกลง",disable:t.popupVisible&&(t.buttonValidateDisable||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1):"actions"===s.name||"actions"===s.edit.type?a("div",{staticClass:"text-center"},[t.hideEditButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"edit",color:"blue",size:"xs",disable:e.row.__readonly__},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),function(){return t.editRow(e.row)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-blue"}},[t._v("แก้ไขข้อมูล")])],1),t.hideRemoveButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"remove",color:"red",size:"xs",disable:e.row.__readonly__},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),function(){return t.removeRow(e.row)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบข้อมูล")])],1),t._t("body",null,{props:e})],2):t._e()])])}))],2)]}},{key:"pagination",fn:function(e){return[a("div",{staticClass:"q-px-sm"},[t._v("\n        "+t._s(t.$q.lang.table.allRows+": "+t.pagination.rowsNumber)+"\n      ")]),a("q-btn",{attrs:{icon:"skip_previous",color:"primary",dense:"",flat:"",disable:e.isFirstPage},on:{click:e.firstPage}}),a("q-btn",{attrs:{icon:"fast_rewind",color:"primary",dense:"",flat:"",disable:e.isFirstPage},on:{click:e.prevPage}}),a("q-select",{staticClass:"q-px-sm",attrs:{borderless:"","hide-dropdown-icon":"","options-dense":"",dense:"",flat:"",options:t.pageOptions,"display-value":t.pagination.page+" - "+t.pagesNumber},on:{input:function(e){return t.onRequest()}},model:{value:t.pagination.page,callback:function(e){t.$set(t.pagination,"page",e)},expression:"pagination.page"}}),a("q-btn",{attrs:{icon:"fast_forward",color:"primary",dense:"",flat:"",disable:e.isLastPage},on:{click:e.nextPage}}),a("q-btn",{attrs:{icon:"skip_next",color:"primary",dense:"",flat:"",disable:e.isLastPage},on:{click:e.lastPage}}),t._t("footer",null,{props:e})]}}],null,!0)})],1)},i=[],n=(a("99af"),a("a623"),a("4de4"),a("7db0"),a("c740"),a("a630"),a("caad"),a("fb6a"),a("45fc"),a("b0c0"),a("2af1"),a("a9e3"),a("cca6"),a("b64b"),a("d3b7"),a("e6cf"),a("ac1f"),a("25f0"),a("8a79"),a("2532"),a("3ca3"),a("5319"),a("1276"),a("2ca0"),a("498a"),a("9523")),o=a.n(n),l=a("7037"),r=a.n(l),c=a("6374"),d=a.n(c),u={name:"JsonTable",model:{prop:"rows",event:"rows"},props:{title:{type:String,default:""},baseUrl:{type:String,default:""},query:{type:String,default:""},table:{type:String,default:""},classes:{type:String,default:""},headerClasses:{type:String,default:""},params:{type:Object,default:function(){}},columns:{type:Array,default:function(){return[]}},rows:{type:Array,default:function(){return[]}},selected:{type:Array,default:function(){return[]}},rowsPerPage:{type:Number,default:10},hidePagination:{type:Boolean,default:!1},hideSearchButton:{type:Boolean,default:!1},hideRefreshButton:{type:Boolean,default:!1},hideAddButton:{type:Boolean,default:!1},hideEditButton:{type:Boolean,default:!1},hideRemoveButton:{type:Boolean,default:!1},showEditDialog:{type:Boolean,default:!1},showSelectedRows:{type:Boolean,default:!1},autoSelectRow:{type:Boolean,default:!0},onInitAddData:{type:Function,default:function(){}},onInitEditData:{type:Function,default:function(){}},onValidateData:{type:Function,default:function(){}},onBeforeLoadData:{type:Function,default:function(){}},onAfterLoadData:{type:Function,default:function(){}},onBeforeUpdateData:{type:Function,default:function(){}},onAfterUpdateData:{type:Function,default:function(){}},onBeforeRemoveData:{type:Function,default:function(){}},onAfterRemoveData:{type:Function,default:function(){}},onDialogVisible:{type:Function,default:function(){}},onPopupVisible:{type:Function,default:function(){}},onFilterSelect:{type:Function,default:function(){}}},data:function(){return{loading:!1,buttonValidateDisable:!1,dialogVisible:!1,popupVisible:!1,isNewRow:!0,filter:void 0,pageOptions:[],data:[],selectedRows:[],argsRequireLoadData:void 0,initialPagination:{pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:this.rowsPerPage,rowsNumber:0},filter:void 0},pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:this.rowsPerPage,rowsNumber:0},inputRefs:{},validateInputs:{},filterOptions:{},editedRow:{},dialogPos:{x:0,y:0}}},computed:{settings:function(){return this.$global.data.settings||{}},pagesNumber:function(){return this.pagination.rowsPerPage>0?Math.ceil(this.pagination.rowsNumber/this.pagination.rowsPerPage):1},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}}},watch:{query:function(t,e){this.onRequest(this.initialPagination)},rows:function(t,e){this.onBeforeLoadData("",t)||(this.data=t,this.$emit("update:rows",[].concat(this.data)),this.pagination.rowsNumber=this.data.length,this.pagination.page=1,this.pagination.rowsPerPage=this.rowsPerPage,this.pagination.sortBy=void 0,this.pagination.descending=void 0,this.onAfterLoadData("",this.data)||this.$emit("load-data",this.table,this.data))},selected:function(t,e){this.selectedRows=t},rowsPerPage:function(t,e){this.pagination.rowsPerPage=t},hidePagination:function(t,e){t?this.pagination.rowsPerPage=0:this.pagination.rowsPerPage<=0&&(this.pagination.rowsPerPage=10)},showEditDialog:function(t,e){this.setShowEditDialog(t)},loading:function(t,e){t?this.$q.loading.show():this.$q.loading.hide()},dialogVisible:function(t,e){var a=this;t?(this.validateInputs={},this.$nextTick((function(){for(var t=Array.from(a.$refs.editDialogRef.$children[0].$el.querySelectorAll("input, textarea")||{}),e=Object.keys(a.$refs),s={},i=0,n=e;i<n.length;i++){var o=n[i],l=[].concat(a.$refs[o]);l.length>0&&function(){var e=l[0].$refs.input||l[0].$refs.target,a=t.findIndex((function(t){return t===e}));a>=0&&(l[0].childIndex=a,s[a]=l[0])}()}a.inputRefs=s,a.inputRefs[0]&&a.$nextTick((function(){return a.inputRefs[0].focus()}))}))):(this.checkRequireLoadData(),delete this.editedRow.__row__),this.onDialogVisible(t,this.editedRow)},popupVisible:function(t,e){t?this.validateInputs={}:this.checkRequireLoadData(),this.onPopupVisible(t,this.editedRow)},selectedRows:function(t,e){this.$emit("update:selected",t)}},mounted:function(){this.onRequest(this.initialPagination)},methods:{checkRequireLoadData:function(){this.argsRequireLoadData&&(this.onRequest.apply(this,this.argsRequireLoadData),this.argsRequireLoadData=void 0)},onRequest:function(t,e){var a=this;if(this.dialogVisible||this.popupVisible)return this.argsRequireLoadData=arguments,void(this.loading=!1);if(!this.baseUrl||!this.table)return this.$emit("load-data",this.table,this.data),void(this.loading=!1);var s=Object.assign({},{pagination:this.pagination,filter:this.filter},t),i=s.pagination,n=i.page,o=i.rowsPerPage,l=i.sortBy,r=i.descending,c=s.filter;if(this.pagination.page=n,this.pagination.rowsPerPage=o,this.pagination.sortBy=l,this.pagination.descending=r,this.filter===c){var d="".concat(this.baseUrl,"/").concat(this.table,"?_sort=").concat(l,"&_order=").concat(r?"desc":"asc").concat(o&&o>0?"&_limit="+o+"&_page="+n:"").concat(c&&c.trim()?"&q="+c.trim():"").concat(this.query&&this.query.trim()?"&"+this.query.trim():"");Promise.resolve(this.onBeforeLoadData(d,this.data)).then((function(t){a.loading=!0;var s=t?Promise.resolve({data:a.data}):a.$jsonFetch.get(d,{params:a.params});s.then((function(t){a.data=t.data,a.$emit("update:rows",[].concat(a.data)),a.pagination.rowsNumber=(t.headers||{})["x-total-count"]||t.data.length,a.pageOptions=a.range(1,a.pagesNumber),a.onAfterLoadData(d,a.data)||(a.$emit("load-data",a.table,a.data),a.showSelectedRows&&(!e&&a.selectedRows.length>0&&(e=a.selectedRows[0].id),a.selectedRows=[].concat(a.data.find((function(t){return t.id===e}))||(a.autoSelectRow&&a.data.length>0?a.data[0]:[])))),a.loading=!1})).catch((function(t){a.loading=!1}))}))}else this.filter=c},setDefaultData:function(){var t,e=d()(this.columns);try{for(e.s();!(t=e.n()).done;){var a=t.value;"object"===r()(a)&&"string"===typeof a.name&&"string"===typeof a.field&&"object"===r()(a.edit)&&"actions"!==a.name&&"actions"!==a.edit.type&&void 0===this.editedRow[a.name]&&("text"===a.edit.type||"textarea"===a.edit.type||"password"===a.edit.type||"datetime"===a.edit.type?this.$set(this.editedRow,a.name,""):"number"!==a.edit.type&&"decimal"!==a.edit.type||this.$set(this.editedRow,a.name,0))}}catch(s){e.e(s)}finally{e.f()}},setShowEditDialog:function(t){t?this.$refs.editDialogRef.show():this.$refs.editDialogRef.hide()},addRow:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.isNewRow=!0,this.editedRow={},this.setDefaultData(),this.editedRow.__row__=JSON.parse(JSON.stringify(this.editedRow)),Promise.resolve(this.onInitAddData(this.editedRow)).then((function(a){!a&&e&&t.setShowEditDialog(!0)})).catch((function(t){})),this.editedRow},editRow:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.isNewRow=!1,this.editedRow=JSON.parse(JSON.stringify(t)),this.setDefaultData(),this.editedRow.__row__=t,Promise.resolve(this.onInitEditData(this.editedRow)).then((function(t){!t&&a&&e.setShowEditDialog(!0)})).catch((function(t){})),this.editedRow},updateRow:function(t){var e=this;if(this.baseUrl&&this.table&&"undefined"!==typeof t.id){if(!0===this.validateData(void 0,t,void 0,!0)){if(this.setDefaultData(),this.isNewRow){delete t.id;var a="".concat(this.baseUrl,"/").concat(this.table);Promise.resolve(this.onBeforeUpdateData(a,t,this.isNewRow)).then((function(s){s?e.loading=!1:(e.loading=!0,e.$jsonFetch.post(a,e.shallowCopy(t),{params:e.params}).then((function(s){s.data.id&&!t.id&&e.$set(t,"id",s.data.id),Promise.resolve(e.onAfterUpdateData(a,t,s.data,e.isNewRow)).then((function(a){a?e.loading=!1:(e.$emit("add-row",e.table,t,s.data),e.$q.notify({type:"positive",message:t.name?"ข้อมูล ".concat(t.name," (รหัส ").concat(t.id,") ได้เพิ่มเรียบร้อยแล้ว"):"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้เพิ่มเรียบร้อยแล้ว")}),e.onRequest(e.initialPagination,t.id))})).catch((function(t){e.loading=!1}))})).catch((function(t){e.loading=!1})))})).catch((function(t){e.loading=!1}))}else{var s="".concat(this.baseUrl,"/").concat(this.table,"/").concat(t.id);Promise.resolve(this.onBeforeUpdateData(s,t,this.isNewRow)).then((function(a){a?e.loading=!1:(e.loading=!0,e.$jsonFetch.put(s,e.shallowCopy(t),{params:e.params}).then((function(a){Promise.resolve(e.onAfterUpdateData(s,t,a.data,e.isNewRow)).then((function(s){s?e.loading=!1:(e.$emit("update-row",e.table,t,a.data),e.$q.notify({type:"positive",message:t.name?"ข้อมูล ".concat(t.name," (รหัส ").concat(t.id,") ได้แก้ไขเรียบร้อยแล้ว"):"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้แก้ไขเรียบร้อยแล้ว")}),e.onRequest(void 0,t.id))})).catch((function(t){e.loading=!1}))})).catch((function(t){e.loading=!1})))})).catch((function(t){e.loading=!1}))}this.setShowEditDialog(!1)}}else this.isNewRow?this.$emit("add-row",this.table,t):this.$emit("update-row",this.table,t)},updateCell:function(t,e){var a=this;if(this.baseUrl&&this.table&&"undefined"!==typeof t.id){if(e&&e.edit){if(!0!==this.validateData(t[e.name],t,e))return;"number"!==e.edit.type&&"decimal"!==e.edit.type||isNaN(t[e.name])||(t[e.name]=+(t[e.name]||0))}var s="".concat(this.baseUrl,"/").concat(this.table,"/").concat(t.id),i=this.shallowCopy(t);Promise.resolve(this.onBeforeUpdateData(s,t)).then((function(n){if(n)a.loading=!1;else{var l=o()({},e.name,t[e.name]);for(var c in i)"object"===r()(t[c])&&null!==t[c]||t[c]===i[c]||(l[c]=t[c]);a.loading=!0,a.$jsonFetch.patch(s,a.shallowCopy(l),{params:a.params}).then((function(i){Promise.resolve(a.onAfterUpdateData(s,t,i.data)).then((function(s){s?a.loading=!1:(a.$emit("update-cell",a.table,t,e,i.data),a.$q.notify({type:"positive",message:t.name?"ข้อมูล ".concat(t.name," (รหัส ").concat(t.id,") ได้แก้ไขเรียบร้อยแล้ว"):"ข้อมูลรหัส ".concat(t.id," ใน ").concat(a.table," ได้แก้ไขเรียบร้อยแล้ว")}),a.onRequest(void 0,t.id))})).catch((function(t){a.loading=!1}))})).catch((function(t){a.loading=!1}))}})).catch((function(t){a.loading=!1}))}else this.$emit("update-cell",this.table,t,e)},removeRow:function(t){var e=this;this.baseUrl&&this.table&&"undefined"!==typeof t.id?this.$q.dialog({title:"การลบข้อมูล",message:"กรุณายืนยันการลบข้อมูลของ ".concat(t.name||""," (รหัส ").concat(t.id,") ?"),ok:{glossy:!0,push:!0,color:"negative",label:"ตกลง"},cancel:{glossy:!0,push:!0,color:"primary",label:"ยกเลิก"},focus:"cancel"}).onOk((function(){var a="".concat(e.baseUrl,"/").concat(e.table,"/").concat(t.id);Promise.resolve(e.onBeforeRemoveData(a,t)).then((function(s){s?e.loading=!1:(e.loading=!0,e.$jsonFetch.delete(a,void 0,{params:e.params}).then((function(s){Promise.resolve(e.onAfterRemoveData(a,t,s.data)).then((function(a){a?e.loading=!1:(e.$emit("remove-row",e.table,t,s.data),e.$q.notify({type:"positive",message:t.name?"ข้อมูล ".concat(t.name," (รหัส ").concat(t.id,") ได้ลบเรียบร้อยแล้ว"):"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้ลบเรียบร้อยแล้ว")}),e.onRequest())})).catch((function(t){e.loading=!1}))})).catch((function(t){e.loading=!1})))})).catch((function(t){e.loading=!1}))})):this.$emit("remove-row",this.table,t)},filterFnAutoSelect:function(t,e,a,s){var i=this;s&&"string"===typeof t?(t=t.replace(/([[\]()^+*/\\?])/g,"\\$1").trim(),this.$jsonFetch.get("".concat(this.baseUrl,"/").concat(s,"?_sort=name&_order=asc&_limit=100&_expand=*&name_like=").concat(t.toLowerCase()),{params:this.params}).then((function(n){Promise.resolve(i.onFilterSelect(t,s,n.data)).then((function(l){i.filterOptions=Object.assign({},i.filterOptions,o()({},s,n.data)),i.doneFilterFn(t,e,a,s)})).catch((function(t){i.filterOptions=Object.assign({},i.filterOptions,o()({},s,[])),a()}))})).catch((function(t){i.filterOptions=Object.assign({},i.filterOptions,o()({},s,[])),a()}))):a()},doneFilterFn:function(t,e,a,s){e((function(){}),(function(e){""!==t&&e.options.length>0&&-1===e.optionIndex&&(e.moveOptionSelection(1,!0),e.toggleOption(e.options[e.optionIndex],!0))}))},abortFilterFn:function(){},getCellDisplay:function(t,e){var a;if("number"===e.edit.type||"decimal"===e.edit.type)if("id"===e.name||e.name.endsWith("Id"))a=(t[e.name.slice(0,-2)]||{}).name||t[e.name];else{a=+this.getCellValue(t,e)||0;var s=Math.sign(a);s<0&&(a*=s),"decimal"===e.edit.type&&(a=a.toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits})),s<0&&(a="".concat(+a,"%"))}else a=this.getCellValue(t,e);return 0===a&&"NaN"!==a||(a=a||" "),"".concat(e.edit.prefix).concat(a).concat(e.edit.suffix)},bindDateTime:function(t){return t=new Date(t),isNaN(t)&&(t=new Date),new Date(t.getTime()-60*t.getTimezoneOffset()*1e3).toISOString().split(".")[0]},eventDateTime:function(t){return t=new Date(t),isNaN(t)&&(t=new Date),t.toISOString()},getCellValue:function(t,e){var a="function"===typeof e.field?e.field(t):t[e.field];return"function"===typeof e.format?e.format(a,t):a},dialogInputEnterKey:function(t,e){var a=this;if("textarea"!==t.target.type){var s=this.$refs[e][0].childIndex;if(s>=0)if(s<Object.keys(this.inputRefs).length-1)"function"===typeof this.inputRefs[s].hidePopup&&this.inputRefs[s].hidePopup(),this.$nextTick((function(){return a.inputRefs[s+1].focus()}));else{var i=document.querySelector("body>div.q-dialog>div>div>div>button.q-btn:last-child:not([disabled])");i&&this.$nextTick((function(){return i.click()}))}}},popupEditEnterKey:function(t){if("textarea"!==t.target.type){var e=document.querySelector("body>div.q-menu>div>div>button.q-btn:last-child:not([disabled])");e&&this.$nextTick((function(){return e.click()}))}},selectOnFocus:function(t){t&&t.target&&"function"===typeof t.target.select&&t.target.select()},changePercentage:function(t,e,a){"%"===t.key&&(e[a.name]*=-1,this.$emit("change-percentage",e[a.name],e,a))},validateData:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,n=!1;if(!0!==i||this.validateData.validateActive)n=s.name.includes(".")||this.onValidateData(t,a,s),void 0===n&&(n="text"===s.edit.type||"textarea"===s.edit.type||"password"===s.edit.type||"datetime"===s.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":("number"===s.edit.type||"decimal"===s.edit.type)&&(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0")),this.validateInputs[s.name]=n,!0!==i&&(this.buttonValidateDisable=!0!==n);else{for(var o in this.validateData.validateActive=!0,this.$refs)this.$refs[o].length>0&&this.$refs[o][0].validate();n=void 0===t&&void 0===s.name||this.validateInputs[s.name],this.buttonValidateDisable=Object.keys(this.validateInputs).some((function(t){return!0!==e.validateInputs[t]})),delete this.validateData.validateActive}return n},deepCompare:function(t,e){var a=Object.prototype.toString.call(t),s=Object.prototype.toString.call(e);return a===s&&("[object Object]"===a||"[object Array]"===a?Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every((function(a){return this.deepCompare(t[a],e[a])})):t===e)},shallowCompare:function(t,e){var a=Object.prototype.toString.call(t),s=Object.prototype.toString.call(e);return a===s&&Object.keys(t).every((function(a){return t[a]===e[a]||"object"===r()(t[a])}))},deepCopy:function(t){if("object"!==r()(t))return t;if(null!==t){var e=Array.isArray(t)?[]:{};for(var a in t)e[a]=this.deepCopy(t[a]);return e}},shallowCopy:function(t){var e=Array.isArray(t)?[]:{};for(var a in t)"object"!==r()(t[a])&&(a.startsWith("_")||a.includes(".")||(e[a]=t[a]));return e},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}},range:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Array.from({length:(e-t)/a+1},(function(e,s){return t+s*a}))},_debug:function(){var t;(t=console).log.apply(t,arguments)}}},p=u,f=(a("613c"),a("2877")),h=a("eaac"),m=a("27f9"),g=a("0016"),b=a("05c0"),y=a("9c40"),_=a("bd08"),v=a("357e"),x=a("8f8e"),w=a("24e8"),q=a("f09f"),D=a("a370"),C=a("d847"),R=a("2c91"),P=a("8572"),$=a("ddd8"),S=a("66e5"),k=a("4074"),V=a("0170"),I=a("4b7e"),F=a("db86"),U=a("7cbe"),L=a("4e73"),T=a("75c3"),E=a("7f67"),j=a("eebe"),Q=a.n(j),B=Object(f["a"])(p,s,i,!1,null,null,null);e["a"]=B.exports;Q()(B,"components",{QTable:h["a"],QInput:m["a"],QIcon:g["a"],QTooltip:b["a"],QBtn:y["a"],QTr:_["a"],QTh:v["a"],QCheckbox:x["a"],QDialog:w["a"],QCard:q["a"],QCardSection:D["a"],QBar:C["a"],QSpace:R["a"],QField:P["a"],QSelect:$["a"],QItem:S["a"],QItemSection:k["a"],QItemLabel:V["a"],QCardActions:I["a"],QTd:F["a"],QPopupProxy:U["a"],QMenu:L["a"]}),Q()(B,"directives",{TouchPan:T["a"],ClosePopup:E["a"]})},f86d:function(t,e,a){"use strict";a("0cbc")},f9ea:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"aboutSettingsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"settings",title:"⭐ ข้อมูลกิจการ ⭐","hide-add-button":"","hide-remove-button":"","hide-pagination":"",classes:(t.$global.data.settings||{}).classes,columns:t.aboutColumns},on:{"update-row":t.updateHandler,"update-cell":t.updateHandler}}),a("JsonTable",{ref:"programSettingsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"settings",title:"⭐ ข้อมูลโปรแกรม ⭐","hide-add-button":"","hide-remove-button":"","hide-pagination":"",classes:(t.$global.data.settings||{}).classes,columns:t.settingColumns},on:{"update-row":t.updateHandler,"update-cell":t.updateHandler}})],1)},i=[],n=(a("99af"),a("caad"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("38cf"),a("1276"),a("ec67")),o=a("1732"),l={name:"PageSettings",data:function(){return{aboutColumns:[{name:"id",label:"รหัสกิจการ",field:"id",sortable:!0,classes:"hidden",headerClasses:"hidden",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อกิจการ",field:"name",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10 text-center",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"password",label:"รหัสผ่าน",field:function(t){return"•".repeat((t.password||"").length)},sortable:!1,classes:"text-green-10 text-center",edit:{type:"password",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],settingColumns:[{name:"id",label:"รหัสการตั้งค่า",field:"id",sortable:!0,classes:"hidden",headerClasses:"hidden",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantityPurchase",label:"จำนวนซื้อเริ่มต้น",field:"quantityPurchase",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"quantitySale",label:"จำนวนขายเริ่มต้น",field:"quantitySale",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"profit",label:"กำไร",field:"profit",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vatPurchase",label:"ภาษีซื้อ",field:"vatPurchase",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vatSale",label:"ภาษีขาย",field:"vatSale",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"fractionDigits",label:"จุดทศนิยม",field:"fractionDigits",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"classes",label:"Cascading Style Sheets",field:"classes",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataSettings:!1}},components:{JsonTable:n["a"]},beforeCreate:function(){this.UID=Object(o["a"])()},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("settings")&&(this.$global.data.panelModel===this.$options.name?(this.$refs.aboutSettingsRef.onRequest(),this.$refs.programSettingsRef.onRequest(),t.response.body&&this.updateHandler("",t.response.body)):this.isRequireLoadDataSettings||(this.isRequireLoadDataSettings=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataSettings&&(this.isRequireLoadDataSettings=!1,this.$refs.aboutSettingsRef.onRequest(),this.$refs.programSettingsRef.onRequest())}},methods:{updateHandler:function(t,e){this.$global.data.settings=Object.assign({},this.$global.data.settings,e),"settings"!==t||!e||e.email===this.$global.data.users.name&&e.password===this.$global.data.users.password||this.updateUserToken(e.email,e.password)},updateUserToken:function(t,e){var a=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/jwt/sign?name=").concat(t,"&password=").concat(e)).then((function(s){var i=s.data.token;a.$jsonFetch.get("".concat(a.$global.data.baseUrl,"/__users"),void 0,{params:{name:t}}).then((function(s){s.data.length>0?a.$jsonFetch.patch("".concat(a.$global.data.baseUrl,"/__users/").concat(s.data[0].id),{name:t,type:"Bearer",token:i},{params:{uid:a.UID}}).then((function(t){a.$global.data.users={name:t.data.name,password:e}})).catch((function(t){})):a.$jsonFetch.post("".concat(a.$global.data.baseUrl,"/__users"),{name:t,type:"Bearer",token:i},{params:{uid:a.UID}}).then((function(t){a.$global.data.users={name:t.data.name,password:e}})).catch((function(t){}))})).catch((function(t){}))})).catch((function(t){}))}}},r=l,c=a("2877"),d=Object(c["a"])(r,s,i,!1,null,null,null);e["a"]=d.exports},fbb2:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"salesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_embed=saleProducts&_expand=customer&_expand=product&_expand=type&_expand=unit",table:"sales",title:"⭐ รายการขายสินค้า ⭐",classes:t.settings.classes,columns:t.saleColumns,onInitAddData:t.onInitAddDataSales,onValidateData:t.onValidateDataSales,onBeforeLoadData:t.onBeforeLoadDataSales,onAfterLoadData:t.onAfterLoadDataSales,onBeforeUpdateData:t.onBeforeUpdateDataSales,onBeforeRemoveData:t.onBeforeRemoveDataSales,onAfterRemoveData:t.onAfterRemoveDataSales,rowsPerPage:5,selected:t.selectedRows,showSelectedRows:"",autoSelectRow:""},on:{"update:selected":[function(e){t.selectedRows=e},t.onSelectedRows]},scopedSlots:t._u([{key:"header",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"print",color:"accent",size:"xs",disable:t.selectedRow.total<=0},on:{click:function(){return t.printData(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-accent"}},[t._v("พิมพ์ข้อมูล")])],1)]}}])}),a("JsonTable",{ref:"saleProductsRef",attrs:{id:"scrollToThis","base-url":this.$global.data.baseUrl,params:{uid:t.UID},title:"⭐ "+t.titleSaleProducts+" ⭐",classes:t.settings.classes,columns:t.saleProductColumns,onInitAddData:t.onInitAddData,onInitEditData:t.onInitEditData,onValidateData:t.onValidateData,onAfterLoadData:t.onAfterLoadData,onFilterSelect:t.onFilterSelect,rowsPerPage:0,showEditDialog:t.showEditDialog,hidePagination:"",hideRefreshButton:"",hideSearchButton:""},on:{"add-row":function(e,a){return t.onUpdateRow(e,a)},"update-row":function(e,a){return t.onUpdateRow(e,a)},"update-cell":function(e,a,s){return t.onUpdateCell(e,a,s)},"remove-row":function(e,a){return t.onRemoveRow(e,a)},"input-select":function(e,a){return t.onInputSelect(e,a)}},scopedSlots:t._u([{key:"header",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",padding:"xs sm",icon:"print",color:"accent",size:"xs",disable:t.selectedRow.total<=0},on:{click:function(){return t.printData(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-accent"}},[t._v("พิมพ์ข้อมูล")])],1)]}}]),model:{value:t.selectedRow.saleProducts,callback:function(e){t.$set(t.selectedRow,"saleProducts",e)},expression:"selectedRow.saleProducts"}}),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},["undefined"!==typeof t.selectedRow.id?a("div",{staticClass:"q-pa-none row wrap justify-center items-start content-start",staticStyle:{width:"297px",border:"1px solid black"},attrs:{id:"printBorder"}},[a("div",{staticClass:"q-pa-sm text-bold"},[a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("img",{attrs:{src:t.images.logo,width:"150"}}),t.settings.address?a("div",[t._v("\n            "+t._s(t.settings.address)+"\n          ")]):t._e(),t.settings.telephone?a("div",[t._v("\n            โทรศัพท์: "+t._s(t.settings.telephone)+"\n          ")]):t._e(),a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            บิลส่งสินค้า\n          ")]),t.selectedRow.date?a("div",{attrs:{align:"center"}},[t._v("\n            "+t._s(new Date(t.selectedRow.date).toLocaleString("th-TH",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))+"\n          ")]):t._e(),t.selectedRow.customer?a("div",{attrs:{align:"left"}},[t.selectedRow.customer.name?a("div",[t._v("\n              นาม: "+t._s(t.selectedRow.customer.name)+"\n            ")]):t._e(),t.selectedRow.customer.address?a("div",[t._v("\n              ที่อยู่: "+t._s(t.selectedRow.customer.address)+"\n            ")]):t._e(),t.selectedRow.customer.telephone?a("div",[t._v("\n              โทรศัพท์: "+t._s(t.selectedRow.customer.telephone)+"\n            ")]):t._e()]):t._e()]),a("div",{staticClass:"q-pa-none"},[t._m(0),t._l(t.selectedRow.saleProducts,(function(e){return a("div",{key:e.id,staticClass:"row"},[a("div",{staticClass:"col-1 text-center"},[t._v(t._s(e.quantity)+"\n              ")]),a("div",{staticClass:"q-px-xs col"},[t._v(t._s((e.product||{}).name))]),a("div",{staticClass:"col-auto text-right"},[t._v(t._s(t.applyDiscount(+e.discount,+e.price).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((t.applyDiscount(+e.discount,+e.price)*(+e.quantity||0)).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])}))],2),a("div",{staticClass:"q-pa-xs"}),a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-4"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("รวม:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s((t.selectedRow.saleProducts||[]).reduce((function(t,e){return t+e.quantity}),0)))]),a("div",{staticClass:"col"},[t._v(" หน่วย")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("จาก:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s((t.selectedRow.saleProducts||[]).length))]),a("div",{staticClass:"col"},[t._v(" รายการ")])])]),a("div",{staticClass:"col-7"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRow.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]),t.selectedRow.discount?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ส่วนลด:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" -"+t._s(t.applyPercentage(+t.selectedRow.discount,+t.selectedRow.total).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),t.selectedRow.vat?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ภาษี:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s(t.applyPercentage(+t.selectedRow.vat,t.applyDiscount(+t.selectedRow.discount,+t.selectedRow.total)).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมสุทธิ:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s(t.applyVat(+t.selectedRow.vat,t.applyDiscount(+t.selectedRow.discount,+t.selectedRow.total)).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])]),t.selectedRow.cash?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ชำระเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRow.cash||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),t.selectedRow.cash?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ทอนเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRow.change||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e()])])]),t._m(1)])]):t._e()]),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.cashDialog,callback:function(e){t.cashDialog=e},expression:"cashDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.titleSaleProducts))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",[a("div",{staticClass:"q-pr-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-sm col-md-auto rounded-borders bg-grey-4"},[a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"1"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?1:+(""+t.cashValue+1)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"2"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?2:+(""+t.cashValue+2)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"3"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?3:+(""+t.cashValue+3)}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"4"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?4:+(""+t.cashValue+4)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"5"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?5:+(""+t.cashValue+5)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"6"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?6:+(""+t.cashValue+6)}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"7"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?7:+(""+t.cashValue+7)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"8"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?8:+(""+t.cashValue+8)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"9"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?9:+(""+t.cashValue+9)}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"cyan",size:"md",label:"C"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?0:t.netValue}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"green",size:"md",label:"0"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?0:+(""+t.cashValue+0)}}})],1),a("div",{staticClass:"q-pa-xs col"},[a("q-btn",{attrs:{glossy:"",color:"cyan",size:"md",label:"<"},on:{click:function(e,a){return t.cashValue=+(""+t.cashValue).slice(0,-1)}}})],1)])]),a("div",{staticClass:"q-pl-sm col"},[a("q-input",{staticClass:"no-spin-button",attrs:{type:"number",autofocus:!t.$global.isMobileAgent(),label:"ชำระเงิน","input-class":"text-right text-h3",rules:[function(t){return t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),function(){return t.cashValue>0&&t.selectedRow.id&&t.updateCashSales(t.selectedRow)}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()}},model:{value:t.cashValue,callback:function(e){t.cashValue=t._n(e)},expression:"cashValue"}}),a("q-input",{attrs:{value:+(+t.netValue||0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ราคาสุทธิ","input-class":"text-right text-h3"}}),a("q-input",{attrs:{value:+(+t.cashValue>(+t.netValue||0)?+t.cashValue-(+t.netValue||0):0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ทอนเงิน","input-class":"text-right text-h3"}})],1)])])]),a("q-card-section",[a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{glossy:"",color:"grey",label:"1000"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?1e3:t.cashValue+1e3}}}),a("q-btn",{attrs:{glossy:"",color:"purple",label:"500"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?500:t.cashValue+500}}}),a("q-btn",{attrs:{glossy:"",color:"red",label:"100"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?100:t.cashValue+100}}}),a("q-btn",{attrs:{glossy:"",color:"blue",label:"50"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?50:t.cashValue+50}}}),a("q-btn",{attrs:{glossy:"",color:"green",label:"20"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?20:t.cashValue+20}}})],1),a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-10",label:"10"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?10:t.cashValue+10}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-9",label:"5"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?5:t.cashValue+5}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-8",label:"2"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?2:t.cashValue+2}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-7",label:"1"},on:{click:function(e,a){return t.cashValue=t.cashValue===t.netValue?1:t.cashValue+1}}})],1),a("q-separator")],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ย้อนกลับไป"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"secondary",label:"รับเงิน ไม่พิมพ์",disable:t.cashValue<=0||t.cashValue<(+t.netValue||0)},on:{click:function(e,a){return t.cashValue>0&&t.selectedRow.id&&t.updateCashSales(t.selectedRow,!1)}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"positive",label:"รับเงิน และพิมพ์",disable:t.cashValue<=0||t.cashValue<(+t.netValue||0)},on:{click:function(e,a){return t.cashValue>0&&t.selectedRow.id&&t.updateCashSales(t.selectedRow)}}})],1)],1)],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",staticStyle:{"text-decoration":"underline"}},[a("div",{staticClass:"col-1 text-center"},[t._v("จำนวน")]),a("div",{staticClass:"col text-center"},[t._v("รายการ")]),a("div",{staticClass:"col-auto text-right"},[t._v("ราคา")]),a("div",{staticClass:"col-3 text-right"},[t._v("รวม")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6"},[t._v("\n            ขอบคุณที่ใช้บริการ\n          ")])])}],n=(a("99af"),a("7db0"),a("4160"),a("caad"),a("c975"),a("e260"),a("13d5"),a("45fc"),a("a434"),a("b0c0"),a("2af1"),a("b680"),a("cca6"),a("b64b"),a("d3b7"),a("e6cf"),a("ac1f"),a("2532"),a("3ca3"),a("1276"),a("498a"),a("159b"),a("ddb0"),a("7037")),o=a.n(n),l=a("ec67"),r=a("1732"),c="bg-blue-1",d="bg-yellow",u={name:"PageSales",data:function(){var t=this;return{EDITE_CLASS:c,ERROR_CLASS:d,saleColumns:[{name:"id",label:"รหัสขาย",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"date",label:"วัน/เดือน/ปี เวลา",field:"date",format:function(t,e){return"".concat(new Date(t).toLocaleString())},sortable:!0,classes:"text-green-10 text-center",edit:{type:"datetime",inputClass:"",prefix:"",suffix:""}},{name:"customerId",label:"ลูกค้า",field:"customerId",sortable:!0,classes:"text-green-10 text-left",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"total",label:"รวม",field:"total",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"vat",label:"ภาษี",field:"vat",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"net",label:"รวมสุทธิ",field:function(e){return t.getNetValue(e)},sortable:!0,headerClasses:"text-weight-bold",classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"cash",label:"ชำระเงิน",field:"cash",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"change",label:"ทอนเงิน",field:"change",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],saleProductColumns:[{name:"product.id",label:"รหัสสินค้า",field:function(t){return(t.product||{}).id},sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.type.name",label:"ประเภทสินค้า",field:function(t){return(t.product||{type:{}}).type.name},sortable:!0,classes:"text-center",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.unit.name",label:"หน่วยนับ",field:function(t){return(t.product||{unit:{}}).unit.name},sortable:!0,classes:"text-center",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"productId",label:"ชื่อสินค้า",field:"productId",sortable:!0,classes:"text-left",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:"",optionLabel:function(t){return t.name?"".concat(t.name):""},optionDetail:function(t){return"★ (ขาย ".concat(t.price||0," บาท) (ทุน ").concat(t.cost||0," บาท) (เหลือ ").concat(t.quantity," ").concat((t.unit||{name:"หน่วย"}).name,")")}}},{name:"cost",label:"ราคาทุน",field:function(t){return t.cost||(t.product||{}).cost||0},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคาขาย",field:"price",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"price.discount",label:"ราคา",field:function(e){return t.applyDiscount(e.discount,e.price)},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวน",field:"quantity",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"total",label:"รวม",field:function(e){return t.applyDiscount(e.discount,e.price)*(e.quantity||1)},sortable:!0,classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],titleSaleProducts:"ขายสินค้า",selectedRows:[],selectedRow:{},isRequireLoadDataSales:!1,isRequireLoadDataSaleProducts:!1,isEditMode:!1,showEditDialog:!1,cashDialog:!1,cashValue:0,netValue:0,dialogPos:{x:0,y:0}}},components:{JsonTable:l["a"]},beforeCreate:function(){this.UID=Object(r["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}},images:{get:function(){return this.$global.data.images||{}}},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}}},watch:{"$global.data.modify":function(t,e){if(t.request&&t.request.query&&t.request.query.uid!==this.UID){var a=t.request.path.split("/");!this.isEditMode&&(a.includes("sales")||a.includes("saleProducts")||a.includes("products"))?this.$global.data.panelModel===this.$options.name?this.$refs.salesRef.onRequest():this.isRequireLoadDataSales||(this.isRequireLoadDataSales=!0):a.includes("customers")&&this.loadDefaultCustomer()}},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataSales&&(this.isRequireLoadDataSales=!1,this.$refs.salesRef.onRequest())}},mounted:function(){void 0===this._keyListener.timeStamp&&(this._keyListener.timeStamp=0,window._keyListener||(window.addEventListener("keydown",this._keyListener),window._keyListener=this._keyListener)),this.loadDefaultCustomer()},beforeDestroy:function(){void 0!==this._keyListener.timeStamp&&(window.removeEventListener("keydown",this._keyListener),delete window._keyListener)},methods:{loadDefaultCustomer:function(){var t=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/customers/1"),{params:{uid:this.UID}}).then((function(e){t.defaultCustomer=e.data})).catch((function(e){t.defaultCustomer={}}))},onInitAddDataSales:function(t){var e=this;if(this.isEditMode){if(this.$refs.salesRef.data.find((function(t){return t.id>0})))return this.$q.notify({type:"warning",message:"ไม่อนุญาตให้เพิ่มข้อมูลในขณะที่กำลังมีการแก้ไขข้อมูล"}),!0}else this.isEditMode=!0,this.$refs.salesRef.data.length=0;return this.$refs.salesRef.data.length<this.$refs.salesRef.pagination.rowsPerPage?(this.$refs.salesRef.data.push(t),this.$refs.salesRef.pagination.rowsNumber=this.$refs.salesRef.data.length,this.selectedRows=[t],t.id=-this.$refs.salesRef.data.length,t.date=(new Date).toISOString(),t.discount=0,t.vat=this.settings.vatSale,t.total=0,t.cash=0,t.change=0,t.customerId=(this.selectedRow||{}).customerId||this.defaultCustomer.id||1,t.customer=(this.selectedRow||{}).customer||this.defaultCustomer||{},t.saleProducts=[],t.__class__=c,this.$global.scrollToElement("scrollToThis",(function(){return e.$refs.saleProductsRef.addRow("undefined"===typeof e.$refs.saleProductsRef.__new__)}),1e3,1e3)):this.$q.notify({type:"warning",message:"ไม่อนุญาตให้เพิ่มข้อมูลมากกว่าจำนวนของ แถวต่อหน้า (".concat(this.$refs.salesRef.pagination.rowsPerPage,")")}),!0},onValidateDataSales:function(t,e,a){return"customerId"===a.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลลูกค้า":"text"===a.edit.type||"textarea"===a.edit.type||"date"===a.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":("number"===a.edit.type||a.edit.type,!0)},onBeforeLoadDataSales:function(t,e){var a=this;if(this.isEditMode)return new Promise((function(t,e){a.$q.dialog({title:"การรีเฟรชข้อมูล",message:"กรุณายืนยันการรีเฟรชข้อมูล ?",ok:{glossy:!0,push:!0,color:"negative",label:"ตกลง"},cancel:{glossy:!0,push:!0,color:"primary",label:"ยกเลิก"},focus:"cancel"}).onOk((function(){a.isEditMode=!1,t(void 0)})).onCancel((function(){t(!0)}))}))},onAfterLoadDataSales:function(t,e){e.forEach((function(t){return Array.isArray(t.saleProducts)&&t.saleProducts.forEach((function(t){return t.__old__=Object.assign({},t.__old__,{quantity:t.quantity})}))})),document.activeElement.blur()},onBeforeUpdateDataSales:function(t,e,a){return this.isEditMode||(this.isEditMode=!0,this.$refs.salesRef.data.length=0,this.$refs.salesRef.data.push(e),this.$refs.salesRef.pagination.rowsNumber=this.$refs.salesRef.data.length,this.selectedRows=[e]),e.cash<0&&(e.cash=0),e.total>0&&e.cash>0?e.change=+(e.cash-this.applyVat(e.vat,this.applyDiscount(e.discount,e.total))).toFixed(this.settings.fractionDigits):e.change=0,e.change<0&&(e.change=0),e.__row__&&Object.keys(e.__row__).forEach((function(t){"object"!==o()(e.__row__[t])&&e.__row__[t]!==e[t]&&(e.__row__[t]=e[t])})),e.__class__=c,e.__row__&&(e.__row__.__class__=c),!0},onBeforeRemoveDataSales:function(t,e){var a=this;if(e.id<0){var s=this.$refs.salesRef.data.indexOf(e);if(s>=0)return this.$refs.salesRef.data.splice(s,1),this.$refs.salesRef.data.length>0?(this.$refs.salesRef.pagination.rowsNumber=this.$refs.salesRef.data.length,this.selectedRows=[this.$refs.salesRef.data[0]]):(this.isEditMode=!1,this.$nextTick((function(){return a.$refs.salesRef.onRequest()}))),!0}},onAfterRemoveDataSales:function(t,e,a){var s=this;e.saleProducts&&[].concat(e.saleProducts,e.saleProducts.__deleted__||[]).forEach((function(t){t.id&&s.$jsonFetch.delete("".concat(s.$global.data.baseUrl,"/saleProducts/").concat(t.id),void 0,{params:{uid:s.UID}}).then((function(e){s.updateQuantityProduct({productId:t.productId,quantity:0,__old__:t.__old__}).then((function(t){})).catch((function(t){}))})).catch((function(t){}))}))},onSelectedRows:function(t){t.length>0?(this.selectedRow=t[0],this.titleSaleProducts="ขายสินค้า ".concat((this.selectedRow.customer||{}).name," [").concat(this.selectedRow.id||"กำลังเพิ่มข้อมูลใหม่","]")):(this.selectedRow={},this.titleSaleProducts="ขายสินค้า"),document.activeElement.blur()},onInitAddData:function(t){if("undefined"===typeof this.selectedRow.id)return this.$q.notify({type:"warning",message:"ยังไม่ได้เลือกรายการขายสินค้า"}),this.showEditDialog=!1,!0;t.saleId=this.selectedRow.id,t.quantity=+this.settings.quantitySale,t.discount=0,t.cost=0,t.__old__={quantity:0},t.__class__=c,this.$refs.saleProductsRef.__new__&&(t.product=this.$refs.saleProductsRef.__new__,t.productId=t.product.id,delete this.$refs.saleProductsRef.__new__,this.onUpdateRow(void 0,t))},onInitEditData:function(t){if("undefined"===typeof this.selectedRow.id)return this.$q.notify({type:"warning",message:"ยังไม่ได้เลือกรายการขายสินค้า"}),this.showEditDialog=!1,!0;t.saleId=this.selectedRow.id,t.__old__=Object.assign({},t.__old__),t.__class__=c},onValidateData:function(t,e,a){return"productId"===a.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลสินค้า":"quantity"===a.name?t<=0?"จำนวนสินค้าต้องมีค่ามากกว่า 0":!(e.product&&e.product.quantity-(t-e.__old__.quantity)<0)||(e.product.quantity<=0?(this.$q.notify({type:"negative",icon:"report_problem",caption:"คงเหลือ: ".concat(e.product.quantity," ").concat(e.product.unit.name),message:"สินค้า: ".concat(e.product.name," (สินค้าหมด)")}),"คงเหลือ: ".concat(e.product.quantity," ").concat(e.product.unit.name)):(this.$q.notify({type:"warning",icon:"report_problem",caption:"คงเหลือ: ".concat(e.product.quantity," ").concat(e.product.unit.name),message:"สินค้า: ".concat(e.product.name," (ไม่เพียงพอ)")}),"คงเหลือ: ".concat(e.product.quantity," ").concat(e.product.unit.name))):"text"===a.edit.type||"textarea"===a.edit.type||"date"===a.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==a.edit.type&&"decimal"!==a.edit.type||(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0")},onAfterLoadData:function(t,e){document.activeElement.blur()},onInputSelect:function(t,e){t.product&&(t.cost=t.product.cost,t.price=t.product.price)},onFilterSelect:function(t,e,a){this.$refs.salesRef.data.forEach((function(t){(t.id<0||t.__class__)&&(t.saleProducts.__deleted__&&t.saleProducts.__deleted__.forEach((function(t){var e=a.find((function(e){return e.id===t.productId}));e&&(e.quantity+=t.__old__.quantity)})),t.saleProducts.forEach((function(t){if(t.__class__){var e=a.find((function(e){return e.id===t.productId}));e&&(e.quantity-=t.quantity-t.__old__.quantity)}})))}))},onUpdateRow:function(t,e){if(this.$refs.saleProductsRef.setShowEditDialog(!1),e&&e.productId&&e.product){if(!0!==this.onValidateData(e.quantity,e,{edit:{},name:"quantity"}))return this.$q.loading.hide();var a=this.selectedRow.saleProducts.find((function(t){return t.productId===e.productId}));a?(Object.keys(a).forEach((function(t){"quantity"!==t&&"object"!==o()(a[t])&&"undefined"!==typeof e[t]&&a[t]!==e[t]&&("discount"===t&&0===e[t]||(a[t]=e[t]))})),a.quantity+=e.quantity-e.__row__.quantity,a.__class__=c):this.selectedRow.saleProducts.push(e),this.selectedRow.total=this.getTotalValue(this.selectedRow.saleProducts),this.selectedRow.total<0&&(this.selectedRow.total=0),this.selectedRow.__class__=c}},onUpdateCell:function(t,e,a){this.$refs.saleProductsRef.setShowEditDialog(!1),this.selectedRow.total=this.getTotalValue(this.selectedRow.saleProducts),this.selectedRow.total<0&&(this.selectedRow.total=0),e.__class__=c,this.selectedRow.__class__=c},onRemoveRow:function(t,e){var a=this;e&&this.$q.dialog({title:"การลบข้อมูล",message:"กรุณายืนยันการลบข้อมูลของ ".concat((e.product||{}).name||""," ?"),ok:{glossy:!0,push:!0,color:"negative",label:"ตกลง"},cancel:{glossy:!0,push:!0,color:"primary",label:"ยกเลิก"},focus:"cancel"}).onOk((function(){var t=a.selectedRow.saleProducts.indexOf(e);t>=0&&(a.selectedRow.saleProducts.splice(t,1),a.selectedRow.total=a.getTotalValue(a.selectedRow.saleProducts),a.selectedRow.total<0&&(a.selectedRow.total=0),e.id>0&&(a.selectedRow.saleProducts.__deleted__=[].concat(a.selectedRow.saleProducts.__deleted__||[],e)),a.selectedRow.__class__=c)}))},getDecimal:function(t){return(+t||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits})},getTotalValue:function(t){var e=this;return+t.reduce((function(t,a){return t+e.applyDiscount(a.discount,a.price)*a.quantity}),0).toFixed(this.settings.fractionDigits)},getNetValue:function(t){return t.total>0?this.applyVat(t.vat,this.applyDiscount(t.discount,t.total)):0},applyPercentage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.sign(t)<0?e*t/-100:t},applyDiscount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e-this.applyPercentage(t,e);return a>=0?a:e},applyVat:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e+this.applyPercentage(t,e);return a>=0?a:e},printData:function(t){var e=this;this.selectedRow.total>0&&(this.isEditMode||this.$refs.salesRef.data.some((function(t){return"undefined"!==typeof t.__class__}))?(this.netValue=this.getNetValue(this.selectedRow),this.cashValue=this.netValue,this.cashDialog=!0):this.selectedRow.cash>0&&(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return e.printBorderVisibility(!0)}))))},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"},updateQuantityProduct:function(t){var e=this;return new Promise((function(a,s){var i={quantityDelta:+(+t.__old__.quantity-+t.quantity).toFixed(e.settings.fractionDigits)};e.$jsonFetch.patch("".concat(e.$global.data.baseUrl,"/products/").concat(t.productId),i,{params:{uid:e.UID}}).then((function(t){a(t)})).catch((function(t){s(t)}))}))},updateCashSales:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(s,i){e.$q.loading.show(),e.cashDialog=!1,t.total=e.getTotalValue(t.saleProducts),t.total<0&&(t.total=0),t.cash=e.cashValue,t.change=+(t.cash-e.applyVat(t.vat,e.applyDiscount(t.discount,t.total))).toFixed(e.settings.fractionDigits),t.change<0&&(t.change=0);var n,o=e.$refs.salesRef.shallowCopy(t);o.id<0?(delete o.id,n=e.$jsonFetch.post("".concat(e.$global.data.baseUrl,"/sales"),o,{params:{uid:e.UID}})):n=e.$jsonFetch.patch("".concat(e.$global.data.baseUrl,"/sales"),o,{params:{uid:e.UID}}),n.then((function(n){t.id=n.data.id;var o=[];t.saleProducts.__deleted__&&t.saleProducts.__deleted__.forEach((function(a){return!(a.quantity=0)&&a.quantity!==a.__old__.quantity&&o.push(e.updateQuantityProduct(a).then((function(t){a.id&&e.$jsonFetch.delete("".concat(e.$global.data.baseUrl,"/saleProducts/").concat(a.id),void 0,{params:{uid:e.UID}}).then((function(t){})).catch((function(t){}))})).catch((function(s){e.$set(a,"__class__",d),t.__class__||e.$set(t,"__class__",a.__class__)})))})),t.saleProducts.forEach((function(a){return a.quantity!==a.__old__.quantity&&o.push(e.updateQuantityProduct(a).then((function(s){a.saleId=t.id,e.$jsonFetch.post("".concat(e.$global.data.baseUrl,"/saleProducts"),e.$refs.salesRef.shallowCopy(a),{params:{uid:e.UID}}).then((function(t){})).catch((function(t){}))})).catch((function(s){e.$set(a,"__class__",d),t.__class__||e.$set(t,"__class__",a.__class__)})))})),Promise.all(o).then((function(i){var o=e.$refs.salesRef.data.indexOf(t);o>=0&&e.$refs.salesRef.data.splice(o,1),delete t.__class__,e.isEditMode=!1,e.$nextTick((function(){return e.$refs.salesRef.onRequest()})),a&&e.printData(),e.$q.loading.hide(),s(n)})).catch((function(t){e.$q.loading.hide(),i(t)}))})).catch((function(t){e.$q.loading.hide(),i(t)}))}))},_keyListener:function(t){if(this.$global.data.panelModel===this.$options.name){var e=document.activeElement.nodeName;if("BODY"!==e&&"INPUT"!==e&&document.activeElement.blur(),t.timeStamp-(this._keyListener.timeStamp||0)>2e3)"Enter"===t.key?(t.preventDefault(),t.stopPropagation(),this._keyListener.text=""):this._keyListener.text=t.key;else{if("Enter"===t.key){t.preventDefault(),t.stopPropagation();var a=this._keyListener.text.trim();return this._keyListener.text="",a&&"INPUT"!==t.target.nodeName&&this.findProductBarcode(a),!1}this._keyListener.text+=t.key}this._keyListener.timeStamp=t.timeStamp}},findProductBarcode:function(t){var e=this;this.$q.loading.show(),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/products?_expand=type&_expand=unit&barcode=").concat(t),{params:{uid:this.UID}}).then((function(a){a.data&&a.data.length>0?e.addProductAutomate(a.data[0]):e.$q.notify({type:"warning",message:"ไม่พบบาร์โค้ด ".concat(t)}),e.$q.loading.hide()})).catch((function(t){e.$q.loading.hide()}))},addProductAutomate:function(t){this.$refs.saleProductsRef.__new__=t,Object.keys(this.selectedRow).length<=0||this.selectedRow.cash>0?this.selectedRows=[this.$refs.salesRef.addRow()]:this.$refs.saleProductsRef.addRow("undefined"===typeof this.$refs.saleProductsRef.__new__)},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}},_debug:function(){var t;(t=console).log.apply(t,arguments)}}},p=u,f=(a("acfe"),a("2877")),h=a("9c40"),m=a("05c0"),g=a("24e8"),b=a("f09f"),y=a("a370"),_=a("d847"),v=a("2c91"),x=a("27f9"),w=a("eb85"),q=a("4b7e"),D=a("75c3"),C=a("7f67"),R=a("eebe"),P=a.n(R),$=Object(f["a"])(p,s,i,!1,null,"41564910",null);e["a"]=$.exports;P()($,"components",{QBtn:h["a"],QTooltip:m["a"],QDialog:g["a"],QCard:b["a"],QCardSection:y["a"],QBar:_["a"],QSpace:v["a"],QInput:x["a"],QSeparator:w["a"],QCardActions:q["a"]}),P()($,"directives",{TouchPan:D["a"],ClosePopup:C["a"]})}}]);